<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark">
    <meta name="google-site-verification" content="i0qQRaR9OA3tSz_9tDocdcXGY27Ox_cy4FrvTHD2C_0" />
    
      <meta name="description" content="aieng-template Python API documentation">
    <link rel="index" title="Index" href="../../../genindex.html" /><link rel="search" title="Search" href="../../../search.html" />

    <meta name="generator" content="sphinx-7.2.6, furo 2024.01.29"/>

    
    <meta name="msvalidate.01" content="8D2A5032F006424CAF54C0DDCD16F666" />
      
        <title>atomgen.models.unimolplus - atomgen documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo-extensions.css?v=36a5483c" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-brand-primary: #faad1a;
  --color-brand-content: #eb088a;
  --color-foreground-secondary: #52c7de;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-brand-primary: #faad1a;
  --color-brand-content: #eb088a;
  --color-foreground-secondary: #52c7de;
  
      }
    }
  }
</style><script src="../../../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../../../_static/doctools.js?v=888ff710"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/scripts/furo.js?v=32e29ea5"></script>
    <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../_static/copybutton.js?v=ccdb6887"></script>
    <script src="../../../_static/design-tabs.js?v=36754332"></script>
    <script src="../../../_static/require.min.js?v=53367eec"></script>
    <script src="../../../_static/custom.js?v=275847af"></script>
    
    <script src="https://kit.fontawesome.com/2c1f516901.js" crossorigin="anonymous"></script>

  </head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../../index.html"><div class="brand">atomgen  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon no-toc" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../../../_static/atomgen_text.png" alt="Logo"/>
  </div>
  
  
</a><form class="sidebar-search-container" method="get" action="../../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../user_guide.html">User Guide (WIP)</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../reference/api/atomgen.data.html">atomgen.data package</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of atomgen.data package</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../reference/api/atomgen.data.data_collator.html">atomgen.data.data_collator module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../reference/api/atomgen.data.tokenizer.html">atomgen.data.tokenizer module</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../reference/api/atomgen.models.html">atomgen.models package</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of atomgen.models package</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../reference/api/atomgen.models.schnet.html">atomgen.models.schnet module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../reference/api/atomgen.models.tokengt.html">atomgen.models.tokengt module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../reference/api/atomgen.models.unimolplus.html">atomgen.models.unimolplus module</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon no-toc" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <h1>Source code for atomgen.models.unimolplus</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;Implementation of the Uni-mol+ model with alterations to the original model.&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Tuple</span>

<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">torch.nn.functional</span> <span class="k">as</span> <span class="nn">f</span>
<span class="kn">from</span> <span class="nn">torch</span> <span class="kn">import</span> <span class="n">nn</span>
<span class="kn">from</span> <span class="nn">transformers.configuration_utils</span> <span class="kn">import</span> <span class="n">PretrainedConfig</span>
<span class="kn">from</span> <span class="nn">transformers.modeling_utils</span> <span class="kn">import</span> <span class="n">PreTrainedModel</span>


<span class="n">ATOM_METADATA</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span>
        <span class="mf">0.0</span><span class="p">,</span>
        <span class="mf">0.0</span><span class="p">,</span>
        <span class="mf">0.0</span><span class="p">,</span>
        <span class="mf">0.0</span><span class="p">,</span>
        <span class="mf">0.0</span><span class="p">,</span>
        <span class="mf">0.0</span><span class="p">,</span>
        <span class="mf">0.0</span><span class="p">,</span>
        <span class="mf">0.106761565836299</span><span class="p">,</span>
        <span class="mf">0.4573170731707318</span><span class="p">,</span>
        <span class="mf">0.46896368424867707</span><span class="p">,</span>
        <span class="mf">0.0</span><span class="p">,</span>
        <span class="mf">0.0</span><span class="p">,</span>
        <span class="mf">0.0027383806383189145</span><span class="p">,</span>
        <span class="mf">0.0</span><span class="p">,</span>
        <span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.0</span><span class="p">,</span>
        <span class="mf">0.0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.008547008547008548</span><span class="p">,</span>
        <span class="mf">0.010187317385107808</span><span class="p">,</span>
        <span class="mf">0.011235955056179775</span><span class="p">,</span>
        <span class="mf">0.008547008547008548</span><span class="p">,</span>
        <span class="mf">0.008547008547008548</span><span class="p">,</span>
        <span class="mf">0.0</span><span class="p">,</span>
        <span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.9999999999999999</span><span class="p">,</span>
        <span class="mf">2.1731754967921256e-06</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.0</span><span class="p">,</span>
        <span class="mf">0.010000000000000002</span><span class="p">,</span>
        <span class="mf">0.3588318085855031</span><span class="p">,</span>
        <span class="mf">0.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.017094017094017096</span><span class="p">,</span>
        <span class="mf">0.02018415404448405</span><span class="p">,</span>
        <span class="mf">0.02247191011235955</span><span class="p">,</span>
        <span class="mf">0.017094017094017096</span><span class="p">,</span>
        <span class="mf">0.017094017094017096</span><span class="p">,</span>
        <span class="mf">0.16666666666666666</span><span class="p">,</span>
        <span class="mf">0.0</span><span class="p">,</span>
        <span class="mf">0.5729537366548044</span><span class="p">,</span>
        <span class="mf">0.08536585365853658</span><span class="p">,</span>
        <span class="mf">0.0723802160098582</span><span class="p">,</span>
        <span class="mf">0.01302222611458848</span><span class="p">,</span>
        <span class="mf">0.1117635470484688</span><span class="p">,</span>
        <span class="mf">0.2746530986669577</span><span class="p">,</span>
        <span class="mf">0.010000000000000002</span><span class="p">,</span>
        <span class="mf">0.2454609429978888</span><span class="p">,</span>
        <span class="mf">0.16666666666666666</span><span class="p">,</span>
        <span class="mf">0.0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.025641025641025644</span><span class="p">,</span>
        <span class="mf">0.027228539455021038</span><span class="p">,</span>
        <span class="mf">0.028089887640449437</span><span class="p">,</span>
        <span class="mf">0.025641025641025644</span><span class="p">,</span>
        <span class="mf">0.025641025641025644</span><span class="p">,</span>
        <span class="mf">0.16666666666666666</span><span class="p">,</span>
        <span class="mf">0.058823529411764705</span><span class="p">,</span>
        <span class="mf">0.32384341637010683</span><span class="p">,</span>
        <span class="mf">0.2652439024390244</span><span class="p">,</span>
        <span class="mf">0.2623432478797689</span><span class="p">,</span>
        <span class="mf">0.0451198574701265</span><span class="p">,</span>
        <span class="mf">0.39298038243761085</span><span class="p">,</span>
        <span class="mf">0.4668171696125004</span><span class="p">,</span>
        <span class="mf">0.015</span><span class="p">,</span>
        <span class="mf">0.12181562280084446</span><span class="p">,</span>
        <span class="mf">0.16666666666666666</span><span class="p">,</span>
        <span class="mf">0.14285714285714285</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.03418803418803419</span><span class="p">,</span>
        <span class="mf">0.03334773276914757</span><span class="p">,</span>
        <span class="mf">0.033707865168539325</span><span class="p">,</span>
        <span class="mf">0.03418803418803419</span><span class="p">,</span>
        <span class="mf">0.03418803418803419</span><span class="p">,</span>
        <span class="mf">0.16666666666666666</span><span class="p">,</span>
        <span class="mf">0.7058823529411764</span><span class="p">,</span>
        <span class="mf">0.25266903914590755</span><span class="p">,</span>
        <span class="mf">0.4085365853658537</span><span class="p">,</span>
        <span class="mf">0.2128252833015198</span><span class="p">,</span>
        <span class="mf">0.057071103187614054</span><span class="p">,</span>
        <span class="mf">0.6504807478441018</span><span class="p">,</span>
        <span class="mf">0.715419845245687</span><span class="p">,</span>
        <span class="mf">0.015</span><span class="p">,</span>
        <span class="mf">0.06558761435608726</span><span class="p">,</span>
        <span class="mf">0.16666666666666666</span><span class="p">,</span>
        <span class="mf">0.2857142857142857</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.042735042735042736</span><span class="p">,</span>
        <span class="mf">0.03742946260625253</span><span class="p">,</span>
        <span class="mf">0.033707865168539325</span><span class="p">,</span>
        <span class="mf">0.042735042735042736</span><span class="p">,</span>
        <span class="mf">0.042735042735042736</span><span class="p">,</span>
        <span class="mf">0.16666666666666666</span><span class="p">,</span>
        <span class="mf">0.7647058823529411</span><span class="p">,</span>
        <span class="mf">0.14946619217081855</span><span class="p">,</span>
        <span class="mf">0.5640243902439024</span><span class="p">,</span>
        <span class="mf">0.3559765143644139</span><span class="p">,</span>
        <span class="mf">0.055363782370830124</span><span class="p">,</span>
        <span class="mf">1.0000000000000002</span><span class="p">,</span>
        <span class="mf">0.7324707832177849</span><span class="p">,</span>
        <span class="mf">0.020000000000000004</span><span class="p">,</span>
        <span class="mf">0.04327938071780436</span><span class="p">,</span>
        <span class="mf">0.16666666666666666</span><span class="p">,</span>
        <span class="mf">0.42857142857142855</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.051282051282051294</span><span class="p">,</span>
        <span class="mf">0.04421873990197045</span><span class="p">,</span>
        <span class="mf">0.03932584269662921</span><span class="p">,</span>
        <span class="mf">0.051282051282051294</span><span class="p">,</span>
        <span class="mf">0.051282051282051294</span><span class="p">,</span>
        <span class="mf">0.16666666666666666</span><span class="p">,</span>
        <span class="mf">0.8235294117647058</span><span class="p">,</span>
        <span class="mf">0.09252669039145908</span><span class="p">,</span>
        <span class="mf">0.7134146341463414</span><span class="p">,</span>
        <span class="mf">0.514180781404789</span><span class="p">,</span>
        <span class="mf">2.8295183993586364e-05</span><span class="p">,</span>
        <span class="mf">0.012484827687008686</span><span class="p">,</span>
        <span class="mf">0.012471056032792366</span><span class="p">,</span>
        <span class="mf">0.025</span><span class="p">,</span>
        <span class="mf">0.06657283603096412</span><span class="p">,</span>
        <span class="mf">0.16666666666666666</span><span class="p">,</span>
        <span class="mf">0.5714285714285714</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.05982905982905984</span><span class="p">,</span>
        <span class="mf">0.050994411431564704</span><span class="p">,</span>
        <span class="mf">0.0449438202247191</span><span class="p">,</span>
        <span class="mf">0.05982905982905984</span><span class="p">,</span>
        <span class="mf">0.05982905982905984</span><span class="p">,</span>
        <span class="mf">0.16666666666666666</span><span class="p">,</span>
        <span class="mf">0.8823529411764706</span><span class="p">,</span>
        <span class="mf">0.05693950177935947</span><span class="p">,</span>
        <span class="mf">0.8353658536585367</span><span class="p">,</span>
        <span class="mf">0.4699156740039142</span><span class="p">,</span>
        <span class="mf">3.268543752245935e-05</span><span class="p">,</span>
        <span class="mf">0.00923366315240946</span><span class="p">,</span>
        <span class="mf">0.014660396468409729</span><span class="p">,</span>
        <span class="mf">0.025</span><span class="p">,</span>
        <span class="mf">0.057987332864180154</span><span class="p">,</span>
        <span class="mf">0.16666666666666666</span><span class="p">,</span>
        <span class="mf">0.7142857142857142</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.06837606837606838</span><span class="p">,</span>
        <span class="mf">0.06119533458279619</span><span class="p">,</span>
        <span class="mf">0.056179775280898875</span><span class="p">,</span>
        <span class="mf">0.06837606837606838</span><span class="p">,</span>
        <span class="mf">0.06837606837606838</span><span class="p">,</span>
        <span class="mf">0.16666666666666666</span><span class="p">,</span>
        <span class="mf">0.9411764705882353</span><span class="p">,</span>
        <span class="mf">0.028469750889679707</span><span class="p">,</span>
        <span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.6537753400826345</span><span class="p">,</span>
        <span class="mf">3.9270817815768815e-05</span><span class="p">,</span>
        <span class="mf">0.01002929606822616</span><span class="p">,</span>
        <span class="mf">0.01377886297525227</span><span class="p">,</span>
        <span class="mf">0.015</span><span class="p">,</span>
        <span class="mf">0.051372273047149884</span><span class="p">,</span>
        <span class="mf">0.16666666666666666</span><span class="p">,</span>
        <span class="mf">0.8571428571428572</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.07692307692307693</span><span class="p">,</span>
        <span class="mf">0.06521583847234458</span><span class="p">,</span>
        <span class="mf">0.056179775280898875</span><span class="p">,</span>
        <span class="mf">0.07692307692307693</span><span class="p">,</span>
        <span class="mf">0.07692307692307693</span><span class="p">,</span>
        <span class="mf">0.16666666666666666</span><span class="p">,</span>
        <span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.007117437722419961</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.8539203131418077</span><span class="p">,</span>
        <span class="mf">1.9758579909666677e-05</span><span class="p">,</span>
        <span class="mf">0.002676173590325307</span><span class="p">,</span>
        <span class="mf">0.003896139326624358</span><span class="p">,</span>
        <span class="mf">0.025</span><span class="p">,</span>
        <span class="mf">0.06586910626319493</span><span class="p">,</span>
        <span class="mf">0.16666666666666666</span><span class="p">,</span>
        <span class="mf">1.0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.08547008547008549</span><span class="p">,</span>
        <span class="mf">0.07477388917423204</span><span class="p">,</span>
        <span class="mf">0.06741573033707865</span><span class="p">,</span>
        <span class="mf">0.08547008547008549</span><span class="p">,</span>
        <span class="mf">0.08547008547008549</span><span class="p">,</span>
        <span class="mf">0.33333333333333337</span><span class="p">,</span>
        <span class="mf">0.0</span><span class="p">,</span>
        <span class="mf">0.6085409252669042</span><span class="p">,</span>
        <span class="mf">0.07012195121951223</span><span class="p">,</span>
        <span class="mf">0.06017348442747725</span><span class="p">,</span>
        <span class="mf">0.023680786070796774</span><span class="p">,</span>
        <span class="mf">0.09074155275516495</span><span class="p">,</span>
        <span class="mf">0.19638929337502856</span><span class="p">,</span>
        <span class="mf">0.020000000000000004</span><span class="p">,</span>
        <span class="mf">0.07980295566502463</span><span class="p">,</span>
        <span class="mf">0.33333333333333337</span><span class="p">,</span>
        <span class="mf">0.0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.09401709401709403</span><span class="p">,</span>
        <span class="mf">0.0792467847873929</span><span class="p">,</span>
        <span class="mf">0.06741573033707865</span><span class="p">,</span>
        <span class="mf">0.09401709401709403</span><span class="p">,</span>
        <span class="mf">0.09401709401709403</span><span class="p">,</span>
        <span class="mf">0.33333333333333337</span><span class="p">,</span>
        <span class="mf">0.058823529411764705</span><span class="p">,</span>
        <span class="mf">0.43060498220640586</span><span class="p">,</span>
        <span class="mf">0.1859756097560976</span><span class="p">,</span>
        <span class="mf">0.18132746997849566</span><span class="p">,</span>
        <span class="mf">0.04243692475803745</span><span class="p">,</span>
        <span class="mf">0.23105764525702377</span><span class="p">,</span>
        <span class="mf">0.2316847349772711</span><span class="p">,</span>
        <span class="mf">0.025</span><span class="p">,</span>
        <span class="mf">0.0653764954257565</span><span class="p">,</span>
        <span class="mf">0.33333333333333337</span><span class="p">,</span>
        <span class="mf">0.14285714285714285</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.10256410256410257</span><span class="p">,</span>
        <span class="mf">0.08835244376566789</span><span class="p">,</span>
        <span class="mf">0.07865168539325842</span><span class="p">,</span>
        <span class="mf">0.10256410256410257</span><span class="p">,</span>
        <span class="mf">0.10256410256410257</span><span class="p">,</span>
        <span class="mf">0.33333333333333337</span><span class="p">,</span>
        <span class="mf">0.7058823529411764</span><span class="p">,</span>
        <span class="mf">0.4661921708185055</span><span class="p">,</span>
        <span class="mf">0.2774390243902439</span><span class="p">,</span>
        <span class="mf">0.10108971416145165</span><span class="p">,</span>
        <span class="mf">0.06585161024536003</span><span class="p">,</span>
        <span class="mf">0.23366315240945865</span><span class="p">,</span>
        <span class="mf">0.4753426385985493</span><span class="p">,</span>
        <span class="mf">0.025</span><span class="p">,</span>
        <span class="mf">0.05650950035186488</span><span class="p">,</span>
        <span class="mf">0.33333333333333337</span><span class="p">,</span>
        <span class="mf">0.2857142857142857</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.11111111111111113</span><span class="p">,</span>
        <span class="mf">0.09210763521580445</span><span class="p">,</span>
        <span class="mf">0.07865168539325842</span><span class="p">,</span>
        <span class="mf">0.11111111111111113</span><span class="p">,</span>
        <span class="mf">0.11111111111111113</span><span class="p">,</span>
        <span class="mf">0.33333333333333337</span><span class="p">,</span>
        <span class="mf">0.7647058823529411</span><span class="p">,</span>
        <span class="mf">0.35943060498220647</span><span class="p">,</span>
        <span class="mf">0.36585365853658536</span><span class="p">,</span>
        <span class="mf">0.20575543044917485</span><span class="p">,</span>
        <span class="mf">0.05682720021378778</span><span class="p">,</span>
        <span class="mf">0.4242464682668294</span><span class="p">,</span>
        <span class="mf">0.6025426358703994</span><span class="p">,</span>
        <span class="mf">0.025</span><span class="p">,</span>
        <span class="mf">0.04299788881069668</span><span class="p">,</span>
        <span class="mf">0.33333333333333337</span><span class="p">,</span>
        <span class="mf">0.42857142857142855</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.11965811965811968</span><span class="p">,</span>
        <span class="mf">0.10193099835710374</span><span class="p">,</span>
        <span class="mf">0.0898876404494382</span><span class="p">,</span>
        <span class="mf">0.11965811965811968</span><span class="p">,</span>
        <span class="mf">0.11965811965811968</span><span class="p">,</span>
        <span class="mf">0.33333333333333337</span><span class="p">,</span>
        <span class="mf">0.8235294117647058</span><span class="p">,</span>
        <span class="mf">0.25266903914590755</span><span class="p">,</span>
        <span class="mf">0.4542682926829268</span><span class="p">,</span>
        <span class="mf">0.3185927948389591</span><span class="p">,</span>
        <span class="mf">0.04438814854864767</span><span class="p">,</span>
        <span class="mf">0.07704039807065373</span><span class="p">,</span>
        <span class="mf">0.09357213740327856</span><span class="p">,</span>
        <span class="mf">0.020000000000000004</span><span class="p">,</span>
        <span class="mf">0.04750175932441942</span><span class="p">,</span>
        <span class="mf">0.33333333333333337</span><span class="p">,</span>
        <span class="mf">0.5714285714285714</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.12820512820512822</span><span class="p">,</span>
        <span class="mf">0.10564197106733833</span><span class="p">,</span>
        <span class="mf">0.0898876404494382</span><span class="p">,</span>
        <span class="mf">0.12820512820512822</span><span class="p">,</span>
        <span class="mf">0.12820512820512822</span><span class="p">,</span>
        <span class="mf">0.33333333333333337</span><span class="p">,</span>
        <span class="mf">0.8823529411764706</span><span class="p">,</span>
        <span class="mf">0.21708185053380794</span><span class="p">,</span>
        <span class="mf">0.5731707317073171</span><span class="p">,</span>
        <span class="mf">0.31247009930654546</span><span class="p">,</span>
        <span class="mf">0.05048572289430458</span><span class="p">,</span>
        <span class="mf">0.09515439218602051</span><span class="p">,</span>
        <span class="mf">0.1216720831812958</span><span class="p">,</span>
        <span class="mf">0.035</span><span class="p">,</span>
        <span class="mf">0.04334975369458127</span><span class="p">,</span>
        <span class="mf">0.33333333333333337</span><span class="p">,</span>
        <span class="mf">0.7142857142857142</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.13675213675213677</span><span class="p">,</span>
        <span class="mf">0.11716605497409803</span><span class="p">,</span>
        <span class="mf">0.10112359550561797</span><span class="p">,</span>
        <span class="mf">0.13675213675213677</span><span class="p">,</span>
        <span class="mf">0.13675213675213677</span><span class="p">,</span>
        <span class="mf">0.33333333333333337</span><span class="p">,</span>
        <span class="mf">0.9411764705882353</span><span class="p">,</span>
        <span class="mf">0.17081850533807832</span><span class="p">,</span>
        <span class="mf">0.75</span><span class="p">,</span>
        <span class="mf">0.43848068233986515</span><span class="p">,</span>
        <span class="mf">7.610016686353661e-05</span><span class="p">,</span>
        <span class="mf">0.04019725595612581</span><span class="p">,</span>
        <span class="mf">0.040050948202660634</span><span class="p">,</span>
        <span class="mf">0.04</span><span class="p">,</span>
        <span class="mf">0.0270935960591133</span><span class="p">,</span>
        <span class="mf">0.33333333333333337</span><span class="p">,</span>
        <span class="mf">0.8571428571428572</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.1452991452991453</span><span class="p">,</span>
        <span class="mf">0.13245553465558702</span><span class="p">,</span>
        <span class="mf">0.12359550561797752</span><span class="p">,</span>
        <span class="mf">0.1452991452991453</span><span class="p">,</span>
        <span class="mf">0.1452991452991453</span><span class="p">,</span>
        <span class="mf">0.33333333333333337</span><span class="p">,</span>
        <span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.13879003558718864</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.573402276077029</span><span class="p">,</span>
        <span class="mf">4.1222041606379033e-05</span><span class="p">,</span>
        <span class="mf">0.0177390552812359</span><span class="p">,</span>
        <span class="mf">0.01416591926721889</span><span class="p">,</span>
        <span class="mf">0.025</span><span class="p">,</span>
        <span class="mf">0.029978888106966927</span><span class="p">,</span>
        <span class="mf">0.33333333333333337</span><span class="p">,</span>
        <span class="mf">1.0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.15384615384615385</span><span class="p">,</span>
        <span class="mf">0.12956430935430432</span><span class="p">,</span>
        <span class="mf">0.11235955056179775</span><span class="p">,</span>
        <span class="mf">0.15384615384615385</span><span class="p">,</span>
        <span class="mf">0.15384615384615385</span><span class="p">,</span>
        <span class="mf">0.5</span><span class="p">,</span>
        <span class="mf">0.0</span><span class="p">,</span>
        <span class="mf">0.8220640569395019</span><span class="p">,</span>
        <span class="mf">0.036585365853658514</span><span class="p">,</span>
        <span class="mf">0.021591320946190845</span><span class="p">,</span>
        <span class="mf">0.02102224365609036</span><span class="p">,</span>
        <span class="mf">0.08193366760083631</span><span class="p">,</span>
        <span class="mf">0.17524613028962724</span><span class="p">,</span>
        <span class="mf">0.035</span><span class="p">,</span>
        <span class="mf">0.04665728360309641</span><span class="p">,</span>
        <span class="mf">0.5</span><span class="p">,</span>
        <span class="mf">0.0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.1623931623931624</span><span class="p">,</span>
        <span class="mf">0.13289772205460673</span><span class="p">,</span>
        <span class="mf">0.11235955056179775</span><span class="p">,</span>
        <span class="mf">0.1623931623931624</span><span class="p">,</span>
        <span class="mf">0.1623931623931624</span><span class="p">,</span>
        <span class="mf">0.5</span><span class="p">,</span>
        <span class="mf">0.058823529411764705</span><span class="p">,</span>
        <span class="mf">0.6085409252669042</span><span class="p">,</span>
        <span class="mf">0.09146341463414634</span><span class="p">,</span>
        <span class="mf">0.10724623674100561</span><span class="p">,</span>
        <span class="mf">0.03755886528151192</span><span class="p">,</span>
        <span class="mf">0.27910065518972543</span><span class="p">,</span>
        <span class="mf">0.2988654305873366</span><span class="p">,</span>
        <span class="mf">0.05500000000000001</span><span class="p">,</span>
        <span class="mf">0.038916256157635463</span><span class="p">,</span>
        <span class="mf">0.5</span><span class="p">,</span>
        <span class="mf">0.14285714285714285</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.17094017094017097</span><span class="p">,</span>
        <span class="mf">0.14948995384243843</span><span class="p">,</span>
        <span class="mf">0.1348314606741573</span><span class="p">,</span>
        <span class="mf">0.17094017094017097</span><span class="p">,</span>
        <span class="mf">0.17094017094017097</span><span class="p">,</span>
        <span class="mf">0.5</span><span class="p">,</span>
        <span class="mf">0.1176470588235294</span><span class="p">,</span>
        <span class="mf">0.5729537366548044</span><span class="p">,</span>
        <span class="mf">0.201219512195122</span><span class="p">,</span>
        <span class="mf">0.128910044216783</span><span class="p">,</span>
        <span class="mf">0.07292479648632205</span><span class="p">,</span>
        <span class="mf">0.4570377290145464</span><span class="p">,</span>
        <span class="mf">0.5293941119700996</span><span class="p">,</span>
        <span class="mf">0.06</span><span class="p">,</span>
        <span class="mf">0.03335679099225897</span><span class="p">,</span>
        <span class="mf">0.5</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.17948717948717952</span><span class="p">,</span>
        <span class="mf">0.15939155013894887</span><span class="p">,</span>
        <span class="mf">0.14606741573033707</span><span class="p">,</span>
        <span class="mf">0.17948717948717952</span><span class="p">,</span>
        <span class="mf">0.17948717948717952</span><span class="p">,</span>
        <span class="mf">0.5</span><span class="p">,</span>
        <span class="mf">0.1764705882352941</span><span class="p">,</span>
        <span class="mf">0.5373665480427048</span><span class="p">,</span>
        <span class="mf">0.25609756097560976</span><span class="p">,</span>
        <span class="mf">0.14179331674197213</span><span class="p">,</span>
        <span class="mf">0.11072975742939495</span><span class="p">,</span>
        <span class="mf">0.48779542320426544</span><span class="p">,</span>
        <span class="mf">0.6062938422242609</span><span class="p">,</span>
        <span class="mf">0.03</span><span class="p">,</span>
        <span class="mf">0.03019000703729768</span><span class="p">,</span>
        <span class="mf">0.5</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.18803418803418806</span><span class="p">,</span>
        <span class="mf">0.16985098284653036</span><span class="p">,</span>
        <span class="mf">0.15730337078651685</span><span class="p">,</span>
        <span class="mf">0.18803418803418806</span><span class="p">,</span>
        <span class="mf">0.18803418803418806</span><span class="p">,</span>
        <span class="mf">0.5</span><span class="p">,</span>
        <span class="mf">0.23529411764705882</span><span class="p">,</span>
        <span class="mf">0.5017793594306051</span><span class="p">,</span>
        <span class="mf">0.2835365853658536</span><span class="p">,</span>
        <span class="mf">0.13783555222654456</span><span class="p">,</span>
        <span class="mf">0.14902252432012042</span><span class="p">,</span>
        <span class="mf">0.5493108115837035</span><span class="p">,</span>
        <span class="mf">0.6267549677907782</span><span class="p">,</span>
        <span class="mf">0.03</span><span class="p">,</span>
        <span class="mf">0.027797325826882473</span><span class="p">,</span>
        <span class="mf">0.5</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.1965811965811966</span><span class="p">,</span>
        <span class="mf">0.17343610222012087</span><span class="p">,</span>
        <span class="mf">0.15730337078651685</span><span class="p">,</span>
        <span class="mf">0.1965811965811966</span><span class="p">,</span>
        <span class="mf">0.1965811965811966</span><span class="p">,</span>
        <span class="mf">0.5</span><span class="p">,</span>
        <span class="mf">0.2941176470588235</span><span class="p">,</span>
        <span class="mf">0.5017793594306051</span><span class="p">,</span>
        <span class="mf">0.29268292682926833</span><span class="p">,</span>
        <span class="mf">0.13881653659361634</span><span class="p">,</span>
        <span class="mf">0.1743884335980532</span><span class="p">,</span>
        <span class="mf">0.5378719996949651</span><span class="p">,</span>
        <span class="mf">0.5012600643161381</span><span class="p">,</span>
        <span class="mf">0.03</span><span class="p">,</span>
        <span class="mf">0.024982406755805767</span><span class="p">,</span>
        <span class="mf">0.5</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.20512820512820515</span><span class="p">,</span>
        <span class="mf">0.1834431432040899</span><span class="p">,</span>
        <span class="mf">0.16853932584269662</span><span class="p">,</span>
        <span class="mf">0.20512820512820515</span><span class="p">,</span>
        <span class="mf">0.20512820512820515</span><span class="p">,</span>
        <span class="mf">0.5</span><span class="p">,</span>
        <span class="mf">0.3529411764705882</span><span class="p">,</span>
        <span class="mf">0.4661921708185055</span><span class="p">,</span>
        <span class="mf">0.25914634146341464</span><span class="p">,</span>
        <span class="mf">0.17107304225964678</span><span class="p">,</span>
        <span class="mf">0.1814616198390152</span><span class="p">,</span>
        <span class="mf">0.38255835382787134</span><span class="p">,</span>
        <span class="mf">0.3972493426863412</span><span class="p">,</span>
        <span class="mf">0.04</span><span class="p">,</span>
        <span class="mf">0.0270935960591133</span><span class="p">,</span>
        <span class="mf">0.5</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.2136752136752137</span><span class="p">,</span>
        <span class="mf">0.18652825067263504</span><span class="p">,</span>
        <span class="mf">0.16853932584269662</span><span class="p">,</span>
        <span class="mf">0.2136752136752137</span><span class="p">,</span>
        <span class="mf">0.2136752136752137</span><span class="p">,</span>
        <span class="mf">0.5</span><span class="p">,</span>
        <span class="mf">0.4117647058823529</span><span class="p">,</span>
        <span class="mf">0.43060498220640586</span><span class="p">,</span>
        <span class="mf">0.3445121951219513</span><span class="p">,</span>
        <span class="mf">0.19370816923188441</span><span class="p">,</span>
        <span class="mf">0.1919494477135451</span><span class="p">,</span>
        <span class="mf">0.4560209457355474</span><span class="p">,</span>
        <span class="mf">0.5336568464631241</span><span class="p">,</span>
        <span class="mf">0.035</span><span class="p">,</span>
        <span class="mf">0.024982406755805767</span><span class="p">,</span>
        <span class="mf">0.5</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.22222222222222224</span><span class="p">,</span>
        <span class="mf">0.19703190212011848</span><span class="p">,</span>
        <span class="mf">0.1797752808988764</span><span class="p">,</span>
        <span class="mf">0.22222222222222224</span><span class="p">,</span>
        <span class="mf">0.22222222222222224</span><span class="p">,</span>
        <span class="mf">0.5</span><span class="p">,</span>
        <span class="mf">0.47058823529411764</span><span class="p">,</span>
        <span class="mf">0.43060498220640586</span><span class="p">,</span>
        <span class="mf">0.3597560975609756</span><span class="p">,</span>
        <span class="mf">0.19267402807644915</span><span class="p">,</span>
        <span class="mf">0.2160958421223465</span><span class="p">,</span>
        <span class="mf">0.4458531129455577</span><span class="p">,</span>
        <span class="mf">0.5449104655247086</span><span class="p">,</span>
        <span class="mf">0.05500000000000001</span><span class="p">,</span>
        <span class="mf">0.023011963406052074</span><span class="p">,</span>
        <span class="mf">0.5</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.2307692307692308</span><span class="p">,</span>
        <span class="mf">0.19621555615269748</span><span class="p">,</span>
        <span class="mf">0.1741573033707865</span><span class="p">,</span>
        <span class="mf">0.2307692307692308</span><span class="p">,</span>
        <span class="mf">0.2307692307692308</span><span class="p">,</span>
        <span class="mf">0.5</span><span class="p">,</span>
        <span class="mf">0.5294117647058824</span><span class="p">,</span>
        <span class="mf">0.3950177935943062</span><span class="p">,</span>
        <span class="mf">0.36890243902439024</span><span class="p">,</span>
        <span class="mf">0.18101819411892625</span><span class="p">,</span>
        <span class="mf">0.2173153569914779</span><span class="p">,</span>
        <span class="mf">0.4351768885160684</span><span class="p">,</span>
        <span class="mf">0.5425233342086149</span><span class="p">,</span>
        <span class="mf">0.04</span><span class="p">,</span>
        <span class="mf">0.024630541871921183</span><span class="p">,</span>
        <span class="mf">0.5</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.23931623931623935</span><span class="p">,</span>
        <span class="mf">0.21272275190225615</span><span class="p">,</span>
        <span class="mf">0.19662921348314605</span><span class="p">,</span>
        <span class="mf">0.23931623931623935</span><span class="p">,</span>
        <span class="mf">0.23931623931623935</span><span class="p">,</span>
        <span class="mf">0.5</span><span class="p">,</span>
        <span class="mf">0.5882352941176471</span><span class="p">,</span>
        <span class="mf">0.3950177935943062</span><span class="p">,</span>
        <span class="mf">0.36585365853658536</span><span class="p">,</span>
        <span class="mf">0.1852030830937251</span><span class="p">,</span>
        <span class="mf">0.2185348718606093</span><span class="p">,</span>
        <span class="mf">0.3415311485202626</span><span class="p">,</span>
        <span class="mf">0.4826745419265514</span><span class="p">,</span>
        <span class="mf">0.04</span><span class="p">,</span>
        <span class="mf">0.02047853624208304</span><span class="p">,</span>
        <span class="mf">0.5</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.2478632478632479</span><span class="p">,</span>
        <span class="mf">0.2189609956699649</span><span class="p">,</span>
        <span class="mf">0.19662921348314605</span><span class="p">,</span>
        <span class="mf">0.2478632478632479</span><span class="p">,</span>
        <span class="mf">0.2478632478632479</span><span class="p">,</span>
        <span class="mf">0.5</span><span class="p">,</span>
        <span class="mf">0.6470588235294117</span><span class="p">,</span>
        <span class="mf">0.35943060498220647</span><span class="p">,</span>
        <span class="mf">0.28963414634146345</span><span class="p">,</span>
        <span class="mf">0.2657984391233962</span><span class="p">,</span>
        <span class="mf">0.17390062765040062</span><span class="p">,</span>
        <span class="mf">0.17252397384325016</span><span class="p">,</span>
        <span class="mf">0.20048151848833204</span><span class="p">,</span>
        <span class="mf">0.06</span><span class="p">,</span>
        <span class="mf">0.020689655172413793</span><span class="p">,</span>
        <span class="mf">0.5</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.2564102564102564</span><span class="p">,</span>
        <span class="mf">0.23373345623875397</span><span class="p">,</span>
        <span class="mf">0.2191011235955056</span><span class="p">,</span>
        <span class="mf">0.2564102564102564</span><span class="p">,</span>
        <span class="mf">0.2564102564102564</span><span class="p">,</span>
        <span class="mf">0.5</span><span class="p">,</span>
        <span class="mf">0.7058823529411764</span><span class="p">,</span>
        <span class="mf">0.4661921708185055</span><span class="p">,</span>
        <span class="mf">0.33841463414634154</span><span class="p">,</span>
        <span class="mf">0.10174209292773093</span><span class="p">,</span>
        <span class="mf">0.14414446484359486</span><span class="p">,</span>
        <span class="mf">0.0733952300154424</span><span class="p">,</span>
        <span class="mf">0.4216321839864411</span><span class="p">,</span>
        <span class="mf">0.05500000000000001</span><span class="p">,</span>
        <span class="mf">0.019493314567206193</span><span class="p">,</span>
        <span class="mf">0.5</span><span class="p">,</span>
        <span class="mf">0.2857142857142857</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.26495726495726496</span><span class="p">,</span>
        <span class="mf">0.24365546118444995</span><span class="p">,</span>
        <span class="mf">0.2303370786516854</span><span class="p">,</span>
        <span class="mf">0.26495726495726496</span><span class="p">,</span>
        <span class="mf">0.26495726495726496</span><span class="p">,</span>
        <span class="mf">0.5</span><span class="p">,</span>
        <span class="mf">0.7647058823529411</span><span class="p">,</span>
        <span class="mf">0.35943060498220647</span><span class="p">,</span>
        <span class="mf">0.39939024390243894</span><span class="p">,</span>
        <span class="mf">0.19356319617271125</span><span class="p">,</span>
        <span class="mf">0.12975418938784455</span><span class="p">,</span>
        <span class="mf">0.30434230009087504</span><span class="p">,</span>
        <span class="mf">0.5288825838309366</span><span class="p">,</span>
        <span class="mf">0.07</span><span class="p">,</span>
        <span class="mf">0.015904292751583393</span><span class="p">,</span>
        <span class="mf">0.5</span><span class="p">,</span>
        <span class="mf">0.42857142857142855</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.27350427350427353</span><span class="p">,</span>
        <span class="mf">0.2514175507580112</span><span class="p">,</span>
        <span class="mf">0.23595505617977527</span><span class="p">,</span>
        <span class="mf">0.27350427350427353</span><span class="p">,</span>
        <span class="mf">0.27350427350427353</span><span class="p">,</span>
        <span class="mf">0.5</span><span class="p">,</span>
        <span class="mf">0.8235294117647058</span><span class="p">,</span>
        <span class="mf">0.2882562277580072</span><span class="p">,</span>
        <span class="mf">0.451219512195122</span><span class="p">,</span>
        <span class="mf">0.28485756396936235</span><span class="p">,</span>
        <span class="mf">0.1409737261838533</span><span class="p">,</span>
        <span class="mf">0.2735083471552311</span><span class="p">,</span>
        <span class="mf">0.15052227023008535</span><span class="p">,</span>
        <span class="mf">0.05500000000000001</span><span class="p">,</span>
        <span class="mf">0.016537649542575653</span><span class="p">,</span>
        <span class="mf">0.5</span><span class="p">,</span>
        <span class="mf">0.5714285714285714</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.28205128205128205</span><span class="p">,</span>
        <span class="mf">0.2651525716598694</span><span class="p">,</span>
        <span class="mf">0.25280898876404495</span><span class="p">,</span>
        <span class="mf">0.28205128205128205</span><span class="p">,</span>
        <span class="mf">0.28205128205128205</span><span class="p">,</span>
        <span class="mf">0.5</span><span class="p">,</span>
        <span class="mf">0.8823529411764706</span><span class="p">,</span>
        <span class="mf">0.25266903914590755</span><span class="p">,</span>
        <span class="mf">0.5640243902439024</span><span class="p">,</span>
        <span class="mf">0.2831082223886727</span><span class="p">,</span>
        <span class="mf">0.11731513772270441</span><span class="p">,</span>
        <span class="mf">0.12200763858438347</span><span class="p">,</span>
        <span class="mf">0.1626284361902748</span><span class="p">,</span>
        <span class="mf">0.085</span><span class="p">,</span>
        <span class="mf">0.01597466572836031</span><span class="p">,</span>
        <span class="mf">0.5</span><span class="p">,</span>
        <span class="mf">0.7142857142857142</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.2905982905982906</span><span class="p">,</span>
        <span class="mf">0.2683635324650587</span><span class="p">,</span>
        <span class="mf">0.25280898876404495</span><span class="p">,</span>
        <span class="mf">0.2905982905982906</span><span class="p">,</span>
        <span class="mf">0.2905982905982906</span><span class="p">,</span>
        <span class="mf">0.5</span><span class="p">,</span>
        <span class="mf">0.9411764705882353</span><span class="p">,</span>
        <span class="mf">0.21708185053380794</span><span class="p">,</span>
        <span class="mf">0.6890243902439025</span><span class="p">,</span>
        <span class="mf">0.38272404378186387</span><span class="p">,</span>
        <span class="mf">0.07609553514606364</span><span class="p">,</span>
        <span class="mf">0.06402557209946683</span><span class="p">,</span>
        <span class="mf">0.055889564484942325</span><span class="p">,</span>
        <span class="mf">0.08</span><span class="p">,</span>
        <span class="mf">0.026741731175228708</span><span class="p">,</span>
        <span class="mf">0.5</span><span class="p">,</span>
        <span class="mf">0.8571428571428572</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.29914529914529914</span><span class="p">,</span>
        <span class="mf">0.2816087457864643</span><span class="p">,</span>
        <span class="mf">0.2696629213483146</span><span class="p">,</span>
        <span class="mf">0.29914529914529914</span><span class="p">,</span>
        <span class="mf">0.29914529914529914</span><span class="p">,</span>
        <span class="mf">0.5</span><span class="p">,</span>
        <span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.18149466192170824</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.48835141469543564</span><span class="p">,</span>
        <span class="mf">8.878312150250298e-05</span><span class="p">,</span>
        <span class="mf">0.025865695638635226</span><span class="p">,</span>
        <span class="mf">0.019729640327514418</span><span class="p">,</span>
        <span class="mf">0.1</span><span class="p">,</span>
        <span class="mf">0.010837438423645322</span><span class="p">,</span>
        <span class="mf">0.5</span><span class="p">,</span>
        <span class="mf">1.0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.3076923076923077</span><span class="p">,</span>
        <span class="mf">0.28728915314310205</span><span class="p">,</span>
        <span class="mf">0.2696629213483146</span><span class="p">,</span>
        <span class="mf">0.3076923076923077</span><span class="p">,</span>
        <span class="mf">0.3076923076923077</span><span class="p">,</span>
        <span class="mf">0.6666666666666666</span><span class="p">,</span>
        <span class="mf">0.0</span><span class="p">,</span>
        <span class="mf">0.8932384341637012</span><span class="p">,</span>
        <span class="mf">0.036585365853658514</span><span class="p">,</span>
        <span class="mf">0.013685456785947292</span><span class="p">,</span>
        <span class="mf">0.03731496230768564</span><span class="p">,</span>
        <span class="mf">0.07590668471456988</span><span class="p">,</span>
        <span class="mf">0.16313996432943775</span><span class="p">,</span>
        <span class="mf">0.085</span><span class="p">,</span>
        <span class="mf">0.01893033075299085</span><span class="p">,</span>
        <span class="mf">0.6666666666666666</span><span class="p">,</span>
        <span class="mf">0.0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.3162393162393162</span><span class="p">,</span>
        <span class="mf">0.2946090553176436</span><span class="p">,</span>
        <span class="mf">0.2808988764044944</span><span class="p">,</span>
        <span class="mf">0.3162393162393162</span><span class="p">,</span>
        <span class="mf">0.3162393162393162</span><span class="p">,</span>
        <span class="mf">0.6666666666666666</span><span class="p">,</span>
        <span class="mf">0.058823529411764705</span><span class="p">,</span>
        <span class="mf">0.7153024911032031</span><span class="p">,</span>
        <span class="mf">0.07621951219512194</span><span class="p">,</span>
        <span class="mf">0.08703215985695992</span><span class="p">,</span>
        <span class="mf">0.06438819240240236</span><span class="p">,</span>
        <span class="mf">0.26130694780724334</span><span class="p">,</span>
        <span class="mf">0.2814734738557968</span><span class="p">,</span>
        <span class="mf">0.075</span><span class="p">,</span>
        <span class="mf">0.014567206192821956</span><span class="p">,</span>
        <span class="mf">0.6666666666666666</span><span class="p">,</span>
        <span class="mf">0.14285714285714285</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.3247863247863248</span><span class="p">,</span>
        <span class="mf">0.29898330912640775</span><span class="p">,</span>
        <span class="mf">0.2808988764044944</span><span class="p">,</span>
        <span class="mf">0.3247863247863248</span><span class="p">,</span>
        <span class="mf">0.3247863247863248</span><span class="p">,</span>
        <span class="mf">0.6666666666666666</span><span class="p">,</span>
        <span class="mf">0.1176470588235294</span><span class="p">,</span>
        <span class="mf">0.6441281138790037</span><span class="p">,</span>
        <span class="mf">0.15853658536585366</span><span class="p">,</span>
        <span class="mf">0.11227680189431463</span><span class="p">,</span>
        <span class="mf">0.109022436612611</span><span class="p">,</span>
        <span class="mf">0.4537331833577997</span><span class="p">,</span>
        <span class="mf">0.6146488018305888</span><span class="p">,</span>
        <span class="mf">0.09</span><span class="p">,</span>
        <span class="mf">0.014356087262491202</span><span class="p">,</span>
        <span class="mf">0.6666666666666666</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.3333333333333333</span><span class="p">,</span>
        <span class="mf">0.3068678505950822</span><span class="p">,</span>
        <span class="mf">0.28651685393258425</span><span class="p">,</span>
        <span class="mf">0.3333333333333333</span><span class="p">,</span>
        <span class="mf">0.3333333333333333</span><span class="p">,</span>
        <span class="mf">0.6666666666666666</span><span class="p">,</span>
        <span class="mf">0.1764705882352941</span><span class="p">,</span>
        <span class="mf">0.6085409252669042</span><span class="p">,</span>
        <span class="mf">0.19207317073170735</span><span class="p">,</span>
        <span class="mf">0.1324087273781622</span><span class="p">,</span>
        <span class="mf">0.15877864327317145</span><span class="p">,</span>
        <span class="mf">0.5366010205962164</span><span class="p">,</span>
        <span class="mf">0.7976053662711987</span><span class="p">,</span>
        <span class="mf">0.085</span><span class="p">,</span>
        <span class="mf">0.012948627726952853</span><span class="p">,</span>
        <span class="mf">0.6666666666666666</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.3418803418803419</span><span class="p">,</span>
        <span class="mf">0.312589075250091</span><span class="p">,</span>
        <span class="mf">0.29213483146067415</span><span class="p">,</span>
        <span class="mf">0.3418803418803419</span><span class="p">,</span>
        <span class="mf">0.3418803418803419</span><span class="p">,</span>
        <span class="mf">0.6666666666666666</span><span class="p">,</span>
        <span class="mf">0.23529411764705882</span><span class="p">,</span>
        <span class="mf">0.5729537366548044</span><span class="p">,</span>
        <span class="mf">0.27439024390243905</span><span class="p">,</span>
        <span class="mf">0.13844927151037764</span><span class="p">,</span>
        <span class="mf">0.2090226558813845</span><span class="p">,</span>
        <span class="mf">0.6931856455620589</span><span class="p">,</span>
        <span class="mf">0.8547260084777264</span><span class="p">,</span>
        <span class="mf">0.105</span><span class="p">,</span>
        <span class="mf">0.012033779028852921</span><span class="p">,</span>
        <span class="mf">0.6666666666666666</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.35042735042735046</span><span class="p">,</span>
        <span class="mf">0.3229770776855231</span><span class="p">,</span>
        <span class="mf">0.3033707865168539</span><span class="p">,</span>
        <span class="mf">0.35042735042735046</span><span class="p">,</span>
        <span class="mf">0.35042735042735046</span><span class="p">,</span>
        <span class="mf">0.6666666666666666</span><span class="p">,</span>
        <span class="mf">0.2941176470588235</span><span class="p">,</span>
        <span class="mf">0.5373665480427048</span><span class="p">,</span>
        <span class="mf">0.44512195121951226</span><span class="p">,</span>
        <span class="mf">0.15456544325512842</span><span class="p">,</span>
        <span class="mf">0.24877884061506758</span><span class="p">,</span>
        <span class="mf">0.7310608227047707</span><span class="p">,</span>
        <span class="mf">0.8368225236070237</span><span class="p">,</span>
        <span class="mf">0.085</span><span class="p">,</span>
        <span class="mf">0.011048557353976075</span><span class="p">,</span>
        <span class="mf">0.6666666666666666</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.358974358974359</span><span class="p">,</span>
        <span class="mf">0.3299160184086015</span><span class="p">,</span>
        <span class="mf">0.3089887640449438</span><span class="p">,</span>
        <span class="mf">0.358974358974359</span><span class="p">,</span>
        <span class="mf">0.358974358974359</span><span class="p">,</span>
        <span class="mf">0.6666666666666666</span><span class="p">,</span>
        <span class="mf">0.3529411764705882</span><span class="p">,</span>
        <span class="mf">0.5373665480427048</span><span class="p">,</span>
        <span class="mf">0.36585365853658536</span><span class="p">,</span>
        <span class="mf">0.16363109188875738</span><span class="p">,</span>
        <span class="mf">0.28048622721248356</span><span class="p">,</span>
        <span class="mf">0.6250611658691273</span><span class="p">,</span>
        <span class="mf">0.8774037559806166</span><span class="p">,</span>
        <span class="mf">0.1</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.6666666666666666</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.36752136752136755</span><span class="p">,</span>
        <span class="mf">0.3403584439085284</span><span class="p">,</span>
        <span class="mf">0.3202247191011236</span><span class="p">,</span>
        <span class="mf">0.36752136752136755</span><span class="p">,</span>
        <span class="mf">0.36752136752136755</span><span class="p">,</span>
        <span class="mf">0.6666666666666666</span><span class="p">,</span>
        <span class="mf">0.4117647058823529</span><span class="p">,</span>
        <span class="mf">0.5017793594306051</span><span class="p">,</span>
        <span class="mf">0.4573170731707318</span><span class="p">,</span>
        <span class="mf">0.16752120230990405</span><span class="p">,</span>
        <span class="mf">0.30243749485684845</span><span class="p">,</span>
        <span class="mf">0.6377709568566146</span><span class="p">,</span>
        <span class="mf">0.7534434369234653</span><span class="p">,</span>
        <span class="mf">0.065</span><span class="p">,</span>
        <span class="mf">0.010133708655876143</span><span class="p">,</span>
        <span class="mf">0.6666666666666666</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.37606837606837606</span><span class="p">,</span>
        <span class="mf">0.346603490559299</span><span class="p">,</span>
        <span class="mf">0.3258426966292135</span><span class="p">,</span>
        <span class="mf">0.37606837606837606</span><span class="p">,</span>
        <span class="mf">0.37606837606837606</span><span class="p">,</span>
        <span class="mf">0.6666666666666666</span><span class="p">,</span>
        <span class="mf">0.47058823529411764</span><span class="p">,</span>
        <span class="mf">0.4661921708185055</span><span class="p">,</span>
        <span class="mf">0.4817073170731707</span><span class="p">,</span>
        <span class="mf">0.17227631865078405</span><span class="p">,</span>
        <span class="mf">0.30243749485684845</span><span class="p">,</span>
        <span class="mf">0.5655793440476872</span><span class="p">,</span>
        <span class="mf">0.67586166915042</span><span class="p">,</span>
        <span class="mf">0.085</span><span class="p">,</span>
        <span class="mf">0.01048557353976073</span><span class="p">,</span>
        <span class="mf">0.6666666666666666</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.38461538461538464</span><span class="p">,</span>
        <span class="mf">0.35855615609895475</span><span class="p">,</span>
        <span class="mf">0.33707865168539325</span><span class="p">,</span>
        <span class="mf">0.38461538461538464</span><span class="p">,</span>
        <span class="mf">0.38461538461538464</span><span class="p">,</span>
        <span class="mf">0.6666666666666666</span><span class="p">,</span>
        <span class="mf">0.5294117647058824</span><span class="p">,</span>
        <span class="mf">0.4661921708185055</span><span class="p">,</span>
        <span class="mf">0.4573170731707318</span><span class="p">,</span>
        <span class="mf">0.21470510063546525</span><span class="p">,</span>
        <span class="mf">0.2926813759037974</span><span class="p">,</span>
        <span class="mf">0.4603422746712931</span><span class="p">,</span>
        <span class="mf">0.5510488031946638</span><span class="p">,</span>
        <span class="mf">0.09</span><span class="p">,</span>
        <span class="mf">0.01055594651653765</span><span class="p">,</span>
        <span class="mf">0.6666666666666666</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.39316239316239315</span><span class="p">,</span>
        <span class="mf">0.363481443435728</span><span class="p">,</span>
        <span class="mf">0.34269662921348315</span><span class="p">,</span>
        <span class="mf">0.39316239316239315</span><span class="p">,</span>
        <span class="mf">0.39316239316239315</span><span class="p">,</span>
        <span class="mf">0.6666666666666666</span><span class="p">,</span>
        <span class="mf">0.5882352941176471</span><span class="p">,</span>
        <span class="mf">0.4661921708185055</span><span class="p">,</span>
        <span class="mf">0.375</span><span class="p">,</span>
        <span class="mf">0.17794476526445505</span><span class="p">,</span>
        <span class="mf">0.25609592982985585</span><span class="p">,</span>
        <span class="mf">0.31011254519919423</span><span class="p">,</span>
        <span class="mf">0.41447079003816</span><span class="p">,</span>
        <span class="mf">0.12000000000000001</span><span class="p">,</span>
        <span class="mf">0.00992258972554539</span><span class="p">,</span>
        <span class="mf">0.6666666666666666</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.4017094017094017</span><span class="p">,</span>
        <span class="mf">0.37893419231070125</span><span class="p">,</span>
        <span class="mf">0.3595505617977528</span><span class="p">,</span>
        <span class="mf">0.4017094017094017</span><span class="p">,</span>
        <span class="mf">0.4017094017094017</span><span class="p">,</span>
        <span class="mf">0.6666666666666666</span><span class="p">,</span>
        <span class="mf">0.6470588235294117</span><span class="p">,</span>
        <span class="mf">0.43060498220640586</span><span class="p">,</span>
        <span class="mf">0.301829268292683</span><span class="p">,</span>
        <span class="mf">0.24644936815908378</span><span class="p">,</span>
        <span class="mf">0.21194949156729978</span><span class="p">,</span>
        <span class="mf">0.1474729758069129</span><span class="p">,</span>
        <span class="mf">0.17661020532739505</span><span class="p">,</span>
        <span class="mf">0.095</span><span class="p">,</span>
        <span class="mf">0.00971147079521464</span><span class="p">,</span>
        <span class="mf">0.6666666666666666</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.4102564102564103</span><span class="p">,</span>
        <span class="mf">0.38712146207562764</span><span class="p">,</span>
        <span class="mf">0.3707865168539326</span><span class="p">,</span>
        <span class="mf">0.4102564102564103</span><span class="p">,</span>
        <span class="mf">0.4102564102564103</span><span class="p">,</span>
        <span class="mf">0.6666666666666666</span><span class="p">,</span>
        <span class="mf">0.7058823529411764</span><span class="p">,</span>
        <span class="mf">0.5373665480427048</span><span class="p">,</span>
        <span class="mf">0.3292682926829269</span><span class="p">,</span>
        <span class="mf">0.09145383816174166</span><span class="p">,</span>
        <span class="mf">0.1782908811792736</span><span class="p">,</span>
        <span class="mf">0.10567809912365993</span><span class="p">,</span>
        <span class="mf">0.39912494586327196</span><span class="p">,</span>
        <span class="mf">0.15500000000000003</span><span class="p">,</span>
        <span class="mf">0.009781843771991556</span><span class="p">,</span>
        <span class="mf">0.6666666666666666</span><span class="p">,</span>
        <span class="mf">0.2857142857142857</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.4188034188034188</span><span class="p">,</span>
        <span class="mf">0.40035987251397137</span><span class="p">,</span>
        <span class="mf">0.38764044943820225</span><span class="p">,</span>
        <span class="mf">0.4188034188034188</span><span class="p">,</span>
        <span class="mf">0.4188034188034188</span><span class="p">,</span>
        <span class="mf">0.6666666666666666</span><span class="p">,</span>
        <span class="mf">0.7647058823529411</span><span class="p">,</span>
        <span class="mf">0.43060498220640586</span><span class="p">,</span>
        <span class="mf">0.38414634146341464</span><span class="p">,</span>
        <span class="mf">0.16671901804914588</span><span class="p">,</span>
        <span class="mf">0.17780307523162106</span><span class="p">,</span>
        <span class="mf">0.12481904435081566</span><span class="p">,</span>
        <span class="mf">0.4894949171153905</span><span class="p">,</span>
        <span class="mf">0.125</span><span class="p">,</span>
        <span class="mf">0.009429978888106968</span><span class="p">,</span>
        <span class="mf">0.6666666666666666</span><span class="p">,</span>
        <span class="mf">0.42857142857142855</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.4273504273504274</span><span class="p">,</span>
        <span class="mf">0.4107342691832799</span><span class="p">,</span>
        <span class="mf">0.398876404494382</span><span class="p">,</span>
        <span class="mf">0.4273504273504274</span><span class="p">,</span>
        <span class="mf">0.4273504273504274</span><span class="p">,</span>
        <span class="mf">0.6666666666666666</span><span class="p">,</span>
        <span class="mf">0.8235294117647058</span><span class="p">,</span>
        <span class="mf">0.35943060498220647</span><span class="p">,</span>
        <span class="mf">0.41158536585365846</span><span class="p">,</span>
        <span class="mf">0.22782516249063714</span><span class="p">,</span>
        <span class="mf">0.16316889680204447</span><span class="p">,</span>
        <span class="mf">0.22620250509980366</span><span class="p">,</span>
        <span class="mf">0.3164278966985974</span><span class="p">,</span>
        <span class="mf">0.13</span><span class="p">,</span>
        <span class="mf">0.007952146375791697</span><span class="p">,</span>
        <span class="mf">0.6666666666666666</span><span class="p">,</span>
        <span class="mf">0.5714285714285714</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.4358974358974359</span><span class="p">,</span>
        <span class="mf">0.43059868772385734</span><span class="p">,</span>
        <span class="mf">0.42696629213483145</span><span class="p">,</span>
        <span class="mf">0.4358974358974359</span><span class="p">,</span>
        <span class="mf">0.4358974358974359</span><span class="p">,</span>
        <span class="mf">0.6666666666666666</span><span class="p">,</span>
        <span class="mf">0.8823529411764706</span><span class="p">,</span>
        <span class="mf">0.32384341637010683</span><span class="p">,</span>
        <span class="mf">0.426829268292683</span><span class="p">,</span>
        <span class="mf">0.24721289293739582</span><span class="p">,</span>
        <span class="mf">0.15194936000603573</span><span class="p">,</span>
        <span class="mf">0.1801295127701625</span><span class="p">,</span>
        <span class="mf">0.21429277824573129</span><span class="p">,</span>
        <span class="mf">0.13</span><span class="p">,</span>
        <span class="mf">0.007600281491907108</span><span class="p">,</span>
        <span class="mf">0.6666666666666666</span><span class="p">,</span>
        <span class="mf">0.7142857142857142</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.4444444444444445</span><span class="p">,</span>
        <span class="mf">0.42823128441833647</span><span class="p">,</span>
        <span class="mf">0.4157303370786517</span><span class="p">,</span>
        <span class="mf">0.4444444444444445</span><span class="p">,</span>
        <span class="mf">0.4444444444444445</span><span class="p">,</span>
        <span class="mf">0.6666666666666666</span><span class="p">,</span>
        <span class="mf">0.9411764705882353</span><span class="p">,</span>
        <span class="mf">0.2882562277580072</span><span class="p">,</span>
        <span class="mf">0.5975609756097562</span><span class="p">,</span>
        <span class="mf">0.31688211274071565</span><span class="p">,</span>
        <span class="mf">0.12024197340861972</span><span class="p">,</span>
        <span class="mf">0.09468158796128598</span><span class="p">,</span>
        <span class="mf">0.07727144070195302</span><span class="p">,</span>
        <span class="mf">0.105</span><span class="p">,</span>
        <span class="mf">0.008444757213230118</span><span class="p">,</span>
        <span class="mf">0.6666666666666666</span><span class="p">,</span>
        <span class="mf">0.8571428571428572</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.452991452991453</span><span class="p">,</span>
        <span class="mf">0.4431602112975479</span><span class="p">,</span>
        <span class="mf">0.43258426966292135</span><span class="p">,</span>
        <span class="mf">0.452991452991453</span><span class="p">,</span>
        <span class="mf">0.452991452991453</span><span class="p">,</span>
        <span class="mf">0.6666666666666666</span><span class="p">,</span>
        <span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.25266903914590755</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.39799453934810447</span><span class="p">,</span>
        <span class="mf">0.0001414661638489788</span><span class="p">,</span>
        <span class="mf">0.03743668935364358</span><span class="p">,</span>
        <span class="mf">0.027419613352930545</span><span class="p">,</span>
        <span class="mf">0.14</span><span class="p">,</span>
        <span class="mf">0.00450387051372273</span><span class="p">,</span>
        <span class="mf">0.6666666666666666</span><span class="p">,</span>
        <span class="mf">1.0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.46153846153846156</span><span class="p">,</span>
        <span class="mf">0.4486433350453922</span><span class="p">,</span>
        <span class="mf">0.4382022471910112</span><span class="p">,</span>
        <span class="mf">0.46153846153846156</span><span class="p">,</span>
        <span class="mf">0.46153846153846156</span><span class="p">,</span>
        <span class="mf">0.8333333333333334</span><span class="p">,</span>
        <span class="mf">0.0</span><span class="p">,</span>
        <span class="mf">1.0000000000000002</span><span class="p">,</span>
        <span class="mf">0.0274390243902439</span><span class="p">,</span>
        <span class="mf">0.0</span><span class="p">,</span>
        <span class="mf">0.045607663417779054</span><span class="p">,</span>
        <span class="mf">0.0730876530735452</span><span class="p">,</span>
        <span class="mf">0.16024130487418112</span><span class="p">,</span>
        <span class="mf">0.095</span><span class="p">,</span>
        <span class="mf">0.010415200562983815</span><span class="p">,</span>
        <span class="mf">0.8333333333333334</span><span class="p">,</span>
        <span class="mf">0.0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.47008547008547014</span><span class="p">,</span>
        <span class="mf">0.463684509495124</span><span class="p">,</span>
        <span class="mf">0.4550561797752809</span><span class="p">,</span>
        <span class="mf">0.47008547008547014</span><span class="p">,</span>
        <span class="mf">0.47008547008547014</span><span class="p">,</span>
        <span class="mf">0.8333333333333334</span><span class="p">,</span>
        <span class="mf">0.058823529411764705</span><span class="p">,</span>
        <span class="mf">0.8220640569395019</span><span class="p">,</span>
        <span class="mf">0.05792682926829271</span><span class="p">,</span>
        <span class="mf">0.06368183245946799</span><span class="p">,</span>
        <span class="mf">0.08755897491589865</span><span class="p">,</span>
        <span class="mf">0.25113911501725356</span><span class="p">,</span>
        <span class="mf">0.36928580441210074</span><span class="p">,</span>
        <span class="mf">0.11</span><span class="p">,</span>
        <span class="mf">0.007741027445460941</span><span class="p">,</span>
        <span class="mf">0.8333333333333334</span><span class="p">,</span>
        <span class="mf">0.14285714285714285</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.47863247863247865</span><span class="p">,</span>
        <span class="mf">0.46905198423091704</span><span class="p">,</span>
        <span class="mf">0.4606741573033708</span><span class="p">,</span>
        <span class="mf">0.47863247863247865</span><span class="p">,</span>
        <span class="mf">0.47863247863247865</span><span class="p">,</span>
        <span class="mf">0.8333333333333334</span><span class="p">,</span>
        <span class="mf">0.1176470588235294</span><span class="p">,</span>
        <span class="mf">0.7864768683274024</span><span class="p">,</span>
        <span class="mf">0.12195121951219515</span><span class="p">,</span>
        <span class="mf">0.08132988619614859</span><span class="p">,</span>
        <span class="mf">0.14999813621542551</span><span class="p">,</span>
        <span class="mf">0.2996905165894547</span><span class="p">,</span>
        <span class="mf">0.6364740024348741</span><span class="p">,</span>
        <span class="mf">0.08</span><span class="p">,</span>
        <span class="mf">0.007107670654468685</span><span class="p">,</span>
        <span class="mf">0.8333333333333334</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.4871794871794872</span><span class="p">,</span>
        <span class="mf">0.47317112992486215</span><span class="p">,</span>
        <span class="mf">0.4606741573033708</span><span class="p">,</span>
        <span class="mf">0.4871794871794872</span><span class="p">,</span>
        <span class="mf">0.4871794871794872</span><span class="p">,</span>
        <span class="mf">0.8333333333333334</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.7864768683274024</span><span class="p">,</span>
        <span class="mf">0.1280487804878049</span><span class="p">,</span>
        <span class="mf">0.07948389590934354</span><span class="p">,</span>
        <span class="mf">0.16512012059265466</span><span class="p">,</span>
        <span class="mf">0.2686786265799859</span><span class="p">,</span>
        <span class="mf">0.6328933054607335</span><span class="p">,</span>
        <span class="mf">0.08</span><span class="p">,</span>
        <span class="mf">0.006896551724137932</span><span class="p">,</span>
        <span class="mf">0.8333333333333334</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.4957264957264958</span><span class="p">,</span>
        <span class="mf">0.47586507161735137</span><span class="p">,</span>
        <span class="mf">0.4606741573033708</span><span class="p">,</span>
        <span class="mf">0.4957264957264958</span><span class="p">,</span>
        <span class="mf">0.4957264957264958</span><span class="p">,</span>
        <span class="mf">0.8333333333333334</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.7864768683274024</span><span class="p">,</span>
        <span class="mf">0.13109756097560973</span><span class="p">,</span>
        <span class="mf">0.07630898591345106</span><span class="p">,</span>
        <span class="mf">0.16512012059265466</span><span class="p">,</span>
        <span class="mf">0.3024866706067019</span><span class="p">,</span>
        <span class="mf">0.6460225276992488</span><span class="p">,</span>
        <span class="mf">0.06</span><span class="p">,</span>
        <span class="mf">0.006966924700914849</span><span class="p">,</span>
        <span class="mf">0.8333333333333334</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.5042735042735044</span><span class="p">,</span>
        <span class="mf">0.48720547768144135</span><span class="p">,</span>
        <span class="mf">0.47191011235955055</span><span class="p">,</span>
        <span class="mf">0.5042735042735044</span><span class="p">,</span>
        <span class="mf">0.5042735042735044</span><span class="p">,</span>
        <span class="mf">0.8333333333333334</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.7508896797153027</span><span class="p">,</span>
        <span class="mf">0.13414634146341461</span><span class="p">,</span>
        <span class="mf">0.07882185227245272</span><span class="p">,</span>
        <span class="mf">0.1709737919644853</span><span class="p">,</span>
        <span class="mf">0.3240933152854302</span><span class="p">,</span>
        <span class="mf">0.5699753443436925</span><span class="p">,</span>
        <span class="mf">0.065</span><span class="p">,</span>
        <span class="mf">0.006755805770584096</span><span class="p">,</span>
        <span class="mf">0.8333333333333334</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.5128205128205129</span><span class="p">,</span>
        <span class="mf">0.4897837703618793</span><span class="p">,</span>
        <span class="mf">0.47191011235955055</span><span class="p">,</span>
        <span class="mf">0.5128205128205129</span><span class="p">,</span>
        <span class="mf">0.5128205128205129</span><span class="p">,</span>
        <span class="mf">0.8333333333333334</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.7508896797153027</span><span class="p">,</span>
        <span class="mf">0.13109756097560973</span><span class="p">,</span>
        <span class="mf">0.08157634039674291</span><span class="p">,</span>
        <span class="mf">0.17707136631014223</span><span class="p">,</span>
        <span class="mf">0.3024866706067019</span><span class="p">,</span>
        <span class="mf">0.55735765024434</span><span class="p">,</span>
        <span class="mf">0.05500000000000001</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.8333333333333334</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.5213675213675214</span><span class="p">,</span>
        <span class="mf">0.5080154969676149</span><span class="p">,</span>
        <span class="mf">0.4943820224719101</span><span class="p">,</span>
        <span class="mf">0.5213675213675214</span><span class="p">,</span>
        <span class="mf">0.5213675213675214</span><span class="p">,</span>
        <span class="mf">0.8333333333333334</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.7508896797153027</span><span class="p">,</span>
        <span class="mf">0.14329268292682926</span><span class="p">,</span>
        <span class="mf">0.0845579529804045</span><span class="p">,</span>
        <span class="mf">0.18341284362962543</span><span class="p">,</span>
        <span class="mf">0.33832828119141584</span><span class="p">,</span>
        <span class="mf">0.35172333830083996</span><span class="p">,</span>
        <span class="mf">0.07</span><span class="p">,</span>
        <span class="mf">0.007248416608022519</span><span class="p">,</span>
        <span class="mf">0.8333333333333334</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.52991452991453</span><span class="p">,</span>
        <span class="mf">0.5134714091832119</span><span class="p">,</span>
        <span class="mf">0.5</span><span class="p">,</span>
        <span class="mf">0.52991452991453</span><span class="p">,</span>
        <span class="mf">0.52991452991453</span><span class="p">,</span>
        <span class="mf">0.8333333333333334</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.7508896797153027</span><span class="p">,</span>
        <span class="mf">0.1524390243902439</span><span class="p">,</span>
        <span class="mf">0.08584821320704569</span><span class="p">,</span>
        <span class="mf">0.12780296559723434</span><span class="p">,</span>
        <span class="mf">0.27477932625397977</span><span class="p">,</span>
        <span class="mf">0.30653835267478063</span><span class="p">,</span>
        <span class="mf">0.09</span><span class="p">,</span>
        <span class="mf">0.0061928219563687536</span><span class="p">,</span>
        <span class="mf">0.8333333333333334</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.5384615384615385</span><span class="p">,</span>
        <span class="mf">0.5314514291156592</span><span class="p">,</span>
        <span class="mf">0.5224719101123595</span><span class="p">,</span>
        <span class="mf">0.5384615384615385</span><span class="p">,</span>
        <span class="mf">0.5384615384615385</span><span class="p">,</span>
        <span class="mf">0.8333333333333334</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.7153024911032031</span><span class="p">,</span>
        <span class="mf">0.1524390243902439</span><span class="p">,</span>
        <span class="mf">0.10902940536883562</span><span class="p">,</span>
        <span class="mf">0.19268115663502394</span><span class="p">,</span>
        <span class="mf">0.3993352779313545</span><span class="p">,</span>
        <span class="mf">0.6039067109081672</span><span class="p">,</span>
        <span class="mf">0.07</span><span class="p">,</span>
        <span class="mf">0.009992962702322309</span><span class="p">,</span>
        <span class="mf">0.8333333333333334</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.5470085470085471</span><span class="p">,</span>
        <span class="mf">0.5371488436799516</span><span class="p">,</span>
        <span class="mf">0.5280898876404494</span><span class="p">,</span>
        <span class="mf">0.5470085470085471</span><span class="p">,</span>
        <span class="mf">0.5470085470085471</span><span class="p">,</span>
        <span class="mf">0.8333333333333334</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.7153024911032031</span><span class="p">,</span>
        <span class="mf">0.1524390243902439</span><span class="p">,</span>
        <span class="mf">0.09519414308840943</span><span class="p">,</span>
        <span class="mf">0.20072995477129107</span><span class="p">,</span>
        <span class="mf">0.41077408982009295</span><span class="p">,</span>
        <span class="mf">0.596574807580165</span><span class="p">,</span>
        <span class="mf">0.105</span><span class="p">,</span>
        <span class="mf">0.0061928219563687536</span><span class="p">,</span>
        <span class="mf">0.8333333333333334</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.5555555555555557</span><span class="p">,</span>
        <span class="mf">0.5493089971529934</span><span class="p">,</span>
        <span class="mf">0.5449438202247191</span><span class="p">,</span>
        <span class="mf">0.5555555555555557</span><span class="p">,</span>
        <span class="mf">0.5555555555555557</span><span class="p">,</span>
        <span class="mf">0.8333333333333334</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.7153024911032031</span><span class="p">,</span>
        <span class="mf">0.15853658536585366</span><span class="p">,</span>
        <span class="mf">0.09882330200304443</span><span class="p">,</span>
        <span class="mf">0.20853484993373195</span><span class="p">,</span>
        <span class="mf">0.42348388080758015</span><span class="p">,</span>
        <span class="mf">0.48352708882515627</span><span class="p">,</span>
        <span class="mf">0.09</span><span class="p">,</span>
        <span class="mf">0.005348346235045743</span><span class="p">,</span>
        <span class="mf">0.8333333333333334</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.5641025641025642</span><span class="p">,</span>
        <span class="mf">0.557574500073131</span><span class="p">,</span>
        <span class="mf">0.550561797752809</span><span class="p">,</span>
        <span class="mf">0.5641025641025642</span><span class="p">,</span>
        <span class="mf">0.5641025641025642</span><span class="p">,</span>
        <span class="mf">0.8333333333333334</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.7153024911032031</span><span class="p">,</span>
        <span class="mf">0.16158536585365854</span><span class="p">,</span>
        <span class="mf">0.10281489356561238</span><span class="p">,</span>
        <span class="mf">0.21463242427938886</span><span class="p">,</span>
        <span class="mf">0.43949821745181405</span><span class="p">,</span>
        <span class="mf">0.509615023922466</span><span class="p">,</span>
        <span class="mf">0.13</span><span class="p">,</span>
        <span class="mf">0.004996481351161154</span><span class="p">,</span>
        <span class="mf">0.8333333333333334</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.5726495726495727</span><span class="p">,</span>
        <span class="mf">0.5654964573986455</span><span class="p">,</span>
        <span class="mf">0.5561797752808989</span><span class="p">,</span>
        <span class="mf">0.5726495726495727</span><span class="p">,</span>
        <span class="mf">0.5726495726495727</span><span class="p">,</span>
        <span class="mf">0.8333333333333334</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.7153024911032031</span><span class="p">,</span>
        <span class="mf">0.16463414634146342</span><span class="p">,</span>
        <span class="mf">0.10698045279918819</span><span class="p">,</span>
        <span class="mf">0.22121780457269832</span><span class="p">,</span>
        <span class="mf">0.45271640007880076</span><span class="p">,</span>
        <span class="mf">0.596574807580165</span><span class="p">,</span>
        <span class="mf">0.065</span><span class="p">,</span>
        <span class="mf">0.005207600281491907</span><span class="p">,</span>
        <span class="mf">0.8333333333333334</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.5811965811965812</span><span class="p">,</span>
        <span class="mf">0.5711938719629379</span><span class="p">,</span>
        <span class="mf">0.5617977528089888</span><span class="p">,</span>
        <span class="mf">0.5811965811965812</span><span class="p">,</span>
        <span class="mf">0.5811965811965812</span><span class="p">,</span>
        <span class="mf">0.8333333333333334</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.6797153024911033</span><span class="p">,</span>
        <span class="mf">0.1676829268292683</span><span class="p">,</span>
        <span class="mf">0.11068209824340977</span><span class="p">,</span>
        <span class="mf">0.22731537891835524</span><span class="p">,</span>
        <span class="mf">0.4585629039330449</span><span class="p">,</span>
        <span class="mf">0.37832280153731257</span><span class="p">,</span>
        <span class="mf">0.075</span><span class="p">,</span>
        <span class="mf">0.004644616467276566</span><span class="p">,</span>
        <span class="mf">0.8333333333333334</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.5897435897435899</span><span class="p">,</span>
        <span class="mf">0.5852078110703316</span><span class="p">,</span>
        <span class="mf">0.5786516853932584</span><span class="p">,</span>
        <span class="mf">0.5897435897435899</span><span class="p">,</span>
        <span class="mf">0.5897435897435899</span><span class="p">,</span>
        <span class="mf">0.8333333333333334</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.6797153024911033</span><span class="p">,</span>
        <span class="mf">0.12195121951219515</span><span class="p">,</span>
        <span class="mf">0.11405997052214464</span><span class="p">,</span>
        <span class="mf">0.1699981800691802</span><span class="p">,</span>
        <span class="mf">0.2752877178934793</span><span class="p">,</span>
        <span class="mf">0.24975872922769482</span><span class="p">,</span>
        <span class="mf">0.065</span><span class="p">,</span>
        <span class="mf">0.004292751583391977</span><span class="p">,</span>
        <span class="mf">0.8333333333333334</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.5982905982905984</span><span class="p">,</span>
        <span class="mf">0.5917147687189832</span><span class="p">,</span>
        <span class="mf">0.5842696629213483</span><span class="p">,</span>
        <span class="mf">0.5982905982905984</span><span class="p">,</span>
        <span class="mf">0.5982905982905984</span><span class="p">,</span>
        <span class="mf">0.8333333333333334</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.6441281138790037</span><span class="p">,</span>
        <span class="mf">0.17378048780487806</span><span class="p">,</span>
        <span class="mf">0.07403290888443234</span><span class="p">,</span>
        <span class="mf">0.2399983335573216</span><span class="p">,</span>
        <span class="mf">0.4885580106635147</span><span class="p">,</span>
        <span class="mf">0.6259024208921734</span><span class="p">,</span>
        <span class="mf">0.095</span><span class="p">,</span>
        <span class="mf">0.00422237860661506</span><span class="p">,</span>
        <span class="mf">0.8333333333333334</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.6068376068376069</span><span class="p">,</span>
        <span class="mf">0.6036980472324172</span><span class="p">,</span>
        <span class="mf">0.5955056179775281</span><span class="p">,</span>
        <span class="mf">0.6068376068376069</span><span class="p">,</span>
        <span class="mf">0.6068376068376069</span><span class="p">,</span>
        <span class="mf">0.8333333333333334</span><span class="p">,</span>
        <span class="mf">0.1764705882352941</span><span class="p">,</span>
        <span class="mf">0.6085409252669042</span><span class="p">,</span>
        <span class="mf">0.1829268292682927</span><span class="p">,</span>
        <span class="mf">0.14164834368279897</span><span class="p">,</span>
        <span class="mf">0.32438876250121335</span><span class="p">,</span>
        <span class="mf">0.6319244530023704</span><span class="p">,</span>
        <span class="mf">0.8306841859370685</span><span class="p">,</span>
        <span class="mf">0.07</span><span class="p">,</span>
        <span class="mf">0.0035186488388458817</span><span class="p">,</span>
        <span class="mf">0.8333333333333334</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.6153846153846155</span><span class="p">,</span>
        <span class="mf">0.6120587905154204</span><span class="p">,</span>
        <span class="mf">0.6067415730337078</span><span class="p">,</span>
        <span class="mf">0.6153846153846155</span><span class="p">,</span>
        <span class="mf">0.6153846153846155</span><span class="p">,</span>
        <span class="mf">0.8333333333333334</span><span class="p">,</span>
        <span class="mf">0.23529411764705882</span><span class="p">,</span>
        <span class="mf">0.5729537366548044</span><span class="p">,</span>
        <span class="mf">0.2439024390243902</span><span class="p">,</span>
        <span class="mf">0.1766593374731196</span><span class="p">,</span>
        <span class="mf">0.40731577360214744</span><span class="p">,</span>
        <span class="mf">0.8274010383899237</span><span class="p">,</span>
        <span class="mf">0.9764697055985051</span><span class="p">,</span>
        <span class="mf">0.08</span><span class="p">,</span>
        <span class="mf">0.003237156931738213</span><span class="p">,</span>
        <span class="mf">0.8333333333333334</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.623931623931624</span><span class="p">,</span>
        <span class="mf">0.6218957594228435</span><span class="p">,</span>
        <span class="mf">0.6179775280898876</span><span class="p">,</span>
        <span class="mf">0.623931623931624</span><span class="p">,</span>
        <span class="mf">0.623931623931624</span><span class="p">,</span>
        <span class="mf">0.8333333333333334</span><span class="p">,</span>
        <span class="mf">0.2941176470588235</span><span class="p">,</span>
        <span class="mf">0.5373665480427048</span><span class="p">,</span>
        <span class="mf">0.5060975609756098</span><span class="p">,</span>
        <span class="mf">0.19185251407446782</span><span class="p">,</span>
        <span class="mf">0.4707305467969794</span><span class="p">,</span>
        <span class="mf">0.9318755203070687</span><span class="p">,</span>
        <span class="mf">0.99300911543144</span><span class="p">,</span>
        <span class="mf">0.095</span><span class="p">,</span>
        <span class="mf">0.002674173117522871</span><span class="p">,</span>
        <span class="mf">0.8333333333333334</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.6324786324786326</span><span class="p">,</span>
        <span class="mf">0.6299469715265329</span><span class="p">,</span>
        <span class="mf">0.6235955056179775</span><span class="p">,</span>
        <span class="mf">0.6324786324786326</span><span class="p">,</span>
        <span class="mf">0.6324786324786326</span><span class="p">,</span>
        <span class="mf">0.8333333333333334</span><span class="p">,</span>
        <span class="mf">0.3529411764705882</span><span class="p">,</span>
        <span class="mf">0.5373665480427048</span><span class="p">,</span>
        <span class="mf">0.36585365853658536</span><span class="p">,</span>
        <span class="mf">0.19037862130620728</span><span class="p">,</span>
        <span class="mf">0.5121940523474464</span><span class="p">,</span>
        <span class="mf">0.8741730692238767</span><span class="p">,</span>
        <span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.09</span><span class="p">,</span>
        <span class="mf">0.00302603800140746</span><span class="p">,</span>
        <span class="mf">0.8333333333333334</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.6410256410256411</span><span class="p">,</span>
        <span class="mf">0.6436309708054273</span><span class="p">,</span>
        <span class="mf">0.6404494382022472</span><span class="p">,</span>
        <span class="mf">0.6410256410256411</span><span class="p">,</span>
        <span class="mf">0.6410256410256411</span><span class="p">,</span>
        <span class="mf">0.8333333333333334</span><span class="p">,</span>
        <span class="mf">0.4117647058823529</span><span class="p">,</span>
        <span class="mf">0.5017793594306051</span><span class="p">,</span>
        <span class="mf">0.4573170731707318</span><span class="p">,</span>
        <span class="mf">0.21960035760021265</span><span class="p">,</span>
        <span class="mf">0.5512185281596508</span><span class="p">,</span>
        <span class="mf">0.8352811088021659</span><span class="p">,</span>
        <span class="mf">0.9004225222429487</span><span class="p">,</span>
        <span class="mf">0.08</span><span class="p">,</span>
        <span class="mf">0.0025334271639690367</span><span class="p">,</span>
        <span class="mf">0.8333333333333334</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.6495726495726497</span><span class="p">,</span>
        <span class="mf">0.650389635127367</span><span class="p">,</span>
        <span class="mf">0.6460674157303371</span><span class="p">,</span>
        <span class="mf">0.6495726495726497</span><span class="p">,</span>
        <span class="mf">0.6495726495726497</span><span class="p">,</span>
        <span class="mf">0.8333333333333334</span><span class="p">,</span>
        <span class="mf">0.47058823529411764</span><span class="p">,</span>
        <span class="mf">0.5017793594306051</span><span class="p">,</span>
        <span class="mf">0.4573170731707318</span><span class="p">,</span>
        <span class="mf">0.24515427549713678</span><span class="p">,</span>
        <span class="mf">0.5512185281596508</span><span class="p">,</span>
        <span class="mf">0.6868307500683152</span><span class="p">,</span>
        <span class="mf">0.8008450444858972</span><span class="p">,</span>
        <span class="mf">0.11</span><span class="p">,</span>
        <span class="mf">0.002603800140745954</span><span class="p">,</span>
        <span class="mf">0.8333333333333334</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.6581196581196582</span><span class="p">,</span>
        <span class="mf">0.6601415679965169</span><span class="p">,</span>
        <span class="mf">0.6573033707865168</span><span class="p">,</span>
        <span class="mf">0.6581196581196582</span><span class="p">,</span>
        <span class="mf">0.6581196581196582</span><span class="p">,</span>
        <span class="mf">0.8333333333333334</span><span class="p">,</span>
        <span class="mf">0.5294117647058824</span><span class="p">,</span>
        <span class="mf">0.4661921708185055</span><span class="p">,</span>
        <span class="mf">0.4817073170731707</span><span class="p">,</span>
        <span class="mf">0.2447531833667577</span><span class="p">,</span>
        <span class="mf">0.5243892010387603</span><span class="p">,</span>
        <span class="mf">0.5162653550162368</span><span class="p">,</span>
        <span class="mf">0.6980278885141472</span><span class="p">,</span>
        <span class="mf">0.14500000000000002</span><span class="p">,</span>
        <span class="mf">0.00274454609429979</span><span class="p">,</span>
        <span class="mf">0.8333333333333334</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.6666666666666667</span><span class="p">,</span>
        <span class="mf">0.6665464823992409</span><span class="p">,</span>
        <span class="mf">0.6629213483146067</span><span class="p">,</span>
        <span class="mf">0.6666666666666667</span><span class="p">,</span>
        <span class="mf">0.6666666666666667</span><span class="p">,</span>
        <span class="mf">0.8333333333333334</span><span class="p">,</span>
        <span class="mf">0.5882352941176471</span><span class="p">,</span>
        <span class="mf">0.4661921708185055</span><span class="p">,</span>
        <span class="mf">0.5609756097560976</span><span class="p">,</span>
        <span class="mf">0.25764612076255833</span><span class="p">,</span>
        <span class="mf">0.4707305467969794</span><span class="p">,</span>
        <span class="mf">0.33644214820887275</span><span class="p">,</span>
        <span class="mf">0.5328042995645191</span><span class="p">,</span>
        <span class="mf">0.09</span><span class="p">,</span>
        <span class="mf">0.002463054187192118</span><span class="p">,</span>
        <span class="mf">0.8333333333333334</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.6752136752136753</span><span class="p">,</span>
        <span class="mf">0.6788699050657669</span><span class="p">,</span>
        <span class="mf">0.6797752808988764</span><span class="p">,</span>
        <span class="mf">0.6752136752136753</span><span class="p">,</span>
        <span class="mf">0.6752136752136753</span><span class="p">,</span>
        <span class="mf">0.8333333333333334</span><span class="p">,</span>
        <span class="mf">0.6470588235294117</span><span class="p">,</span>
        <span class="mf">0.4661921708185055</span><span class="p">,</span>
        <span class="mf">0.39634146341463417</span><span class="p">,</span>
        <span class="mf">0.31621523666851903</span><span class="p">,</span>
        <span class="mf">0.3292668219777389</span><span class="p">,</span>
        <span class="mf">0.05598790027897992</span><span class="p">,</span>
        <span class="mf">0.1067013596417939</span><span class="p">,</span>
        <span class="mf">0.115</span><span class="p">,</span>
        <span class="mf">0.003237156931738213</span><span class="p">,</span>
        <span class="mf">0.8333333333333334</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.6837606837606839</span><span class="p">,</span>
        <span class="mf">0.6917715727925495</span><span class="p">,</span>
        <span class="mf">0.6910112359550562</span><span class="p">,</span>
        <span class="mf">0.6837606837606839</span><span class="p">,</span>
        <span class="mf">0.6837606837606839</span><span class="p">,</span>
        <span class="mf">0.8333333333333334</span><span class="p">,</span>
        <span class="mf">0.7058823529411764</span><span class="p">,</span>
        <span class="mf">0.5729537366548044</span><span class="p">,</span>
        <span class="mf">0.4085365853658537</span><span class="p">,</span>
        <span class="mf">0.10700461497571703</span><span class="p">,</span>
        <span class="mf">0.2902423461655346</span><span class="p">,</span>
        <span class="mf">0.14310589162361226</span><span class="p">,</span>
        <span class="mf">0.29698982741040586</span><span class="p">,</span>
        <span class="mf">0.125</span><span class="p">,</span>
        <span class="mf">0.002463054187192118</span><span class="p">,</span>
        <span class="mf">0.8333333333333334</span><span class="p">,</span>
        <span class="mf">0.2857142857142857</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.6923076923076924</span><span class="p">,</span>
        <span class="mf">0.7013534335851533</span><span class="p">,</span>
        <span class="mf">0.7022471910112359</span><span class="p">,</span>
        <span class="mf">0.6923076923076924</span><span class="p">,</span>
        <span class="mf">0.6923076923076924</span><span class="p">,</span>
        <span class="mf">0.8333333333333334</span><span class="p">,</span>
        <span class="mf">0.7647058823529411</span><span class="p">,</span>
        <span class="mf">0.4661921708185055</span><span class="p">,</span>
        <span class="mf">0.4969512195121951</span><span class="p">,</span>
        <span class="mf">0.1702370309517481</span><span class="p">,</span>
        <span class="mf">0.27560816773595803</span><span class="p">,</span>
        <span class="mf">0.14910491296970624</span><span class="p">,</span>
        <span class="mf">0.3440504162133959</span><span class="p">,</span>
        <span class="mf">0.13</span><span class="p">,</span>
        <span class="mf">0.002463054187192118</span><span class="p">,</span>
        <span class="mf">0.8333333333333334</span><span class="p">,</span>
        <span class="mf">0.42857142857142855</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.7008547008547009</span><span class="p">,</span>
        <span class="mf">0.7074079995101924</span><span class="p">,</span>
        <span class="mf">0.7078651685393258</span><span class="p">,</span>
        <span class="mf">0.7008547008547009</span><span class="p">,</span>
        <span class="mf">0.7008547008547009</span><span class="p">,</span>
        <span class="mf">0.8333333333333334</span><span class="p">,</span>
        <span class="mf">0.8235294117647058</span><span class="p">,</span>
        <span class="mf">0.3950177935943062</span><span class="p">,</span>
        <span class="mf">0.4024390243902439</span><span class="p">,</span>
        <span class="mf">0.1639017082658806</span><span class="p">,</span>
        <span class="mf">0.2392666246358428</span><span class="p">,</span>
        <span class="mf">0.13484961139814058</span><span class="p">,</span>
        <span class="mf">0.31250618096501487</span><span class="p">,</span>
        <span class="mf">0.08</span><span class="p">,</span>
        <span class="mf">0.0019704433497536944</span><span class="p">,</span>
        <span class="mf">0.8333333333333334</span><span class="p">,</span>
        <span class="mf">0.5714285714285714</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.7094017094017095</span><span class="p">,</span>
        <span class="mf">0.7108774698717316</span><span class="p">,</span>
        <span class="mf">0.7078651685393258</span><span class="p">,</span>
        <span class="mf">0.7094017094017095</span><span class="p">,</span>
        <span class="mf">0.7094017094017095</span><span class="p">,</span>
        <span class="mf">0.8333333333333334</span><span class="p">,</span>
        <span class="mf">0.8823529411764706</span><span class="p">,</span>
        <span class="mf">0.35943060498220647</span><span class="p">,</span>
        <span class="mf">0.39634146341463417</span><span class="p">,</span>
        <span class="mf">0.21857588131538888</span><span class="p">,</span>
        <span class="mf">0.22731537891835524</span><span class="p">,</span>
        <span class="mf">0.13039610063612506</span><span class="p">,</span>
        <span class="mf">0.20985953437298585</span><span class="p">,</span>
        <span class="mf">0.15500000000000003</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.8333333333333334</span><span class="p">,</span>
        <span class="mf">0.7142857142857142</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.7179487179487181</span><span class="p">,</span>
        <span class="mf">0.7108774698717316</span><span class="p">,</span>
        <span class="mf">0.7022471910112359</span><span class="p">,</span>
        <span class="mf">0.7179487179487181</span><span class="p">,</span>
        <span class="mf">0.7179487179487181</span><span class="p">,</span>
        <span class="mf">0.8333333333333334</span><span class="p">,</span>
        <span class="mf">0.9411764705882353</span><span class="p">,</span>
        <span class="mf">0.32384341637010683</span><span class="p">,</span>
        <span class="mf">0.4573170731707318</span><span class="p">,</span>
        <span class="mf">0.26124628506535874</span><span class="p">,</span>
        <span class="mf">0.17072988899065902</span><span class="p">,</span>
        <span class="mf">0.14259749998411278</span><span class="p">,</span>
        <span class="mf">0.10329117204737433</span><span class="p">,</span>
        <span class="mf">0.09</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.8333333333333334</span><span class="p">,</span>
        <span class="mf">0.8571428571428572</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.7264957264957266</span><span class="p">,</span>
        <span class="mf">0.7516947682427814</span><span class="p">,</span>
        <span class="mf">0.7640449438202247</span><span class="p">,</span>
        <span class="mf">0.7264957264957266</span><span class="p">,</span>
        <span class="mf">0.7264957264957266</span><span class="p">,</span>
        <span class="mf">0.8333333333333334</span><span class="p">,</span>
        <span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.2882562277580072</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.3312441104694711</span><span class="p">,</span>
        <span class="mf">0.00023512490579826907</span><span class="p">,</span>
        <span class="mf">0.047782459217458176</span><span class="p">,</span>
        <span class="mf">0.03530908235262022</span><span class="p">,</span>
        <span class="mf">0.085</span><span class="p">,</span>
        <span class="mf">0.0</span><span class="p">,</span>
        <span class="mf">0.8333333333333334</span><span class="p">,</span>
        <span class="mf">1.0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.7350427350427351</span><span class="p">,</span>
        <span class="mf">0.7550962097737021</span><span class="p">,</span>
        <span class="mf">0.7640449438202247</span><span class="p">,</span>
        <span class="mf">0.7350427350427351</span><span class="p">,</span>
        <span class="mf">0.7350427350427351</span><span class="p">,</span>
        <span class="mf">0.9999999999999999</span><span class="p">,</span>
        <span class="mf">0.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.0</span><span class="p">,</span>
        <span class="mf">0.00864039432672098</span><span class="p">,</span>
        <span class="mf">0.045607663417779054</span><span class="p">,</span>
        <span class="mf">0.0726936495529331</span><span class="p">,</span>
        <span class="mf">0.161264361152507</span><span class="p">,</span>
        <span class="mf">0.09</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.9999999999999999</span><span class="p">,</span>
        <span class="mf">0.0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.7435897435897437</span><span class="p">,</span>
        <span class="mf">0.7653005343664645</span><span class="p">,</span>
        <span class="mf">0.7752808988764045</span><span class="p">,</span>
        <span class="mf">0.7435897435897437</span><span class="p">,</span>
        <span class="mf">0.7435897435897437</span><span class="p">,</span>
        <span class="mf">0.9999999999999999</span><span class="p">,</span>
        <span class="mf">0.058823529411764705</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.06097560975609759</span><span class="p">,</span>
        <span class="mf">0.06690506680841815</span><span class="p">,</span>
        <span class="mf">0.1341444429167175</span><span class="p">,</span>
        <span class="mf">0.243767436244511</span><span class="p">,</span>
        <span class="mf">0.34200430365674417</span><span class="p">,</span>
        <span class="mf">0.06</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.9999999999999999</span><span class="p">,</span>
        <span class="mf">0.14285714285714285</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.7521367521367522</span><span class="p">,</span>
        <span class="mf">0.7687019758973853</span><span class="p">,</span>
        <span class="mf">0.7752808988764045</span><span class="p">,</span>
        <span class="mf">0.7521367521367522</span><span class="p">,</span>
        <span class="mf">0.7521367521367522</span><span class="p">,</span>
        <span class="mf">0.9999999999999999</span><span class="p">,</span>
        <span class="mf">0.1176470588235294</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.12195121951219515</span><span class="p">,</span>
        <span class="mf">0.061666706936960886</span><span class="p">,</span>
        <span class="mf">0.24633981087680482</span><span class="p">,</span>
        <span class="mf">0.3327359731569215</span><span class="p">,</span>
        <span class="mf">0.5911185074290938</span><span class="p">,</span>
        <span class="mf">0.04</span><span class="p">,</span>
        <span class="mf">0.0018296973961998584</span><span class="p">,</span>
        <span class="mf">0.9999999999999999</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.7606837606837608</span><span class="p">,</span>
        <span class="mf">0.7858384383301644</span><span class="p">,</span>
        <span class="mf">0.797752808988764</span><span class="p">,</span>
        <span class="mf">0.7606837606837608</span><span class="p">,</span>
        <span class="mf">0.7606837606837608</span><span class="p">,</span>
        <span class="mf">0.9999999999999999</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.1829268292682927</span><span class="p">,</span>
        <span class="mf">0.11659699905767515</span><span class="p">,</span>
        <span class="mf">0.28536428668900904</span><span class="p">,</span>
        <span class="mf">0.5119440260804912</span><span class="p">,</span>
        <span class="mf">0.8622284211854495</span><span class="p">,</span>
        <span class="mf">0.045</span><span class="p">,</span>
        <span class="mf">0.001337086558761435</span><span class="p">,</span>
        <span class="mf">0.9999999999999999</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.7692307692307694</span><span class="p">,</span>
        <span class="mf">0.7824301939161817</span><span class="p">,</span>
        <span class="mf">0.7865168539325842</span><span class="p">,</span>
        <span class="mf">0.7692307692307694</span><span class="p">,</span>
        <span class="mf">0.7692307692307694</span><span class="p">,</span>
        <span class="mf">0.9999999999999999</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.2439024390243902</span><span class="p">,</span>
        <span class="mf">0.09646024113852172</span><span class="p">,</span>
        <span class="mf">0.3756083870047315</span><span class="p">,</span>
        <span class="mf">0.4725436740192808</span><span class="p">,</span>
        <span class="mf">0.7324707832177849</span><span class="p">,</span>
        <span class="mf">0.05500000000000001</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.9999999999999999</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.7777777777777779</span><span class="p">,</span>
        <span class="mf">0.8062164745419109</span><span class="p">,</span>
        <span class="mf">0.8202247191011236</span><span class="p">,</span>
        <span class="mf">0.7777777777777779</span><span class="p">,</span>
        <span class="mf">0.7777777777777779</span><span class="p">,</span>
        <span class="mf">0.9999999999999999</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.2073170731707317</span><span class="p">,</span>
        <span class="mf">0.11115567690337544</span><span class="p">,</span>
        <span class="mf">0.4634134575821911</span><span class="p">,</span>
        <span class="mf">0.3535800303764005</span><span class="p">,</span>
        <span class="mf">0.7502037587087667</span><span class="p">,</span>
        <span class="mf">0.06</span><span class="p">,</span>
        <span class="mf">0.00154820548909219</span><span class="p">,</span>
        <span class="mf">0.9999999999999999</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.7863247863247864</span><span class="p">,</span>
        <span class="mf">0.8027163912065933</span><span class="p">,</span>
        <span class="mf">0.8089887640449438</span><span class="p">,</span>
        <span class="mf">0.7863247863247864</span><span class="p">,</span>
        <span class="mf">0.7863247863247864</span><span class="p">,</span>
        <span class="mf">0.9999999999999999</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.201219512195122</span><span class="p">,</span>
        <span class="mf">0.11461570058230844</span><span class="p">,</span>
        <span class="mf">0.49999890365613264</span><span class="p">,</span>
        <span class="mf">0.22851568705952632</span><span class="p">,</span>
        <span class="mf">0.7278670299653185</span><span class="p">,</span>
        <span class="mf">0.75</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.9999999999999999</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.7948717948717949</span><span class="p">,</span>
        <span class="mf">0.826526481923039</span><span class="p">,</span>
        <span class="mf">0.8426966292134831</span><span class="p">,</span>
        <span class="mf">0.7948717948717949</span><span class="p">,</span>
        <span class="mf">0.7948717948717949</span><span class="p">,</span>
        <span class="mf">0.9999999999999999</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.17682926829268295</span><span class="p">,</span>
        <span class="mf">0.10304201802498372</span><span class="p">,</span>
        <span class="mf">0.4829256954882932</span><span class="p">,</span>
        <span class="mf">0.22851568705952632</span><span class="p">,</span>
        <span class="mf">0.5962337888207231</span><span class="p">,</span>
        <span class="mf">0.8</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.9999999999999999</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.8034188034188036</span><span class="p">,</span>
        <span class="mf">0.8231250403921182</span><span class="p">,</span>
        <span class="mf">0.8314606741573034</span><span class="p">,</span>
        <span class="mf">0.8034188034188036</span><span class="p">,</span>
        <span class="mf">0.8034188034188036</span><span class="p">,</span>
        <span class="mf">0.9999999999999999</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.1829268292682927</span><span class="p">,</span>
        <span class="mf">0.10050982192475896</span><span class="p">,</span>
        <span class="mf">0.3341448814542644</span><span class="p">,</span>
        <span class="mf">0.3185010072509358</span><span class="p">,</span>
        <span class="mf">0.4903474640139954</span><span class="p">,</span>
        <span class="mf">0.65</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.9999999999999999</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.8119658119658121</span><span class="p">,</span>
        <span class="mf">0.8367308065158015</span><span class="p">,</span>
        <span class="mf">0.848314606741573</span><span class="p">,</span>
        <span class="mf">0.8119658119658121</span><span class="p">,</span>
        <span class="mf">0.8119658119658121</span><span class="p">,</span>
        <span class="mf">0.9999999999999999</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.1829268292682927</span><span class="p">,</span>
        <span class="mf">0.10136516297388068</span><span class="p">,</span>
        <span class="mf">0.3292668219777389</span><span class="p">,</span>
        <span class="mf">0.3370573020926671</span><span class="p">,</span>
        <span class="mf">0.5761136820136477</span><span class="p">,</span>
        <span class="mf">0.65</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.9999999999999999</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.8205128205128206</span><span class="p">,</span>
        <span class="mf">0.8367308065158015</span><span class="p">,</span>
        <span class="mf">0.8426966292134831</span><span class="p">,</span>
        <span class="mf">0.8205128205128206</span><span class="p">,</span>
        <span class="mf">0.8205128205128206</span><span class="p">,</span>
        <span class="mf">0.9999999999999999</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.1829268292682927</span><span class="p">,</span>
        <span class="mf">0.11133930944499479</span><span class="p">,</span>
        <span class="mf">0.3609742085751549</span><span class="p">,</span>
        <span class="mf">0.31646744069293786</span><span class="p">,</span>
        <span class="mf">0.16689117068329928</span><span class="p">,</span>
        <span class="mf">0.4</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.9999999999999999</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.8290598290598292</span><span class="p">,</span>
        <span class="mf">0.8503365726394846</span><span class="p">,</span>
        <span class="mf">0.8595505617977528</span><span class="p">,</span>
        <span class="mf">0.8290598290598292</span><span class="p">,</span>
        <span class="mf">0.8290598290598292</span><span class="p">,</span>
        <span class="mf">0.9999999999999999</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.1829268292682927</span><span class="p">,</span>
        <span class="mf">0.11538889023123203</span><span class="p">,</span>
        <span class="mf">0.3682912977899432</span><span class="p">,</span>
        <span class="mf">0.48576185664626753</span><span class="p">,</span>
        <span class="mf">0.1992879528302852</span><span class="p">,</span>
        <span class="mf">0.6</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.9999999999999999</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.8376068376068377</span><span class="p">,</span>
        <span class="mf">0.8537380141704054</span><span class="p">,</span>
        <span class="mf">0.8595505617977528</span><span class="p">,</span>
        <span class="mf">0.8376068376068377</span><span class="p">,</span>
        <span class="mf">0.8376068376068377</span><span class="p">,</span>
        <span class="mf">0.9999999999999999</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.1829268292682927</span><span class="p">,</span>
        <span class="mf">0.12207214825911519</span><span class="p">,</span>
        <span class="mf">0.3292668219777389</span><span class="p">,</span>
        <span class="mf">0.28443876740447005</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.6</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.9999999999999999</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.8461538461538463</span><span class="p">,</span>
        <span class="mf">0.8707452218250095</span><span class="p">,</span>
        <span class="mf">0.8820224719101123</span><span class="p">,</span>
        <span class="mf">0.8461538461538463</span><span class="p">,</span>
        <span class="mf">0.8461538461538463</span><span class="p">,</span>
        <span class="mf">0.9999999999999999</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.1829268292682927</span><span class="p">,</span>
        <span class="mf">0.12593809650373308</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.5</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.9999999999999999</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.8547008547008548</span><span class="p">,</span>
        <span class="mf">0.8741466633559303</span><span class="p">,</span>
        <span class="mf">0.8820224719101123</span><span class="p">,</span>
        <span class="mf">0.8547008547008548</span><span class="p">,</span>
        <span class="mf">0.8547008547008548</span><span class="p">,</span>
        <span class="mf">0.9999999999999999</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.1829268292682927</span><span class="p">,</span>
        <span class="mf">0.12980404474835092</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.15000000000000002</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.9999999999999999</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.8632478632478634</span><span class="p">,</span>
        <span class="mf">0.8775481048868511</span><span class="p">,</span>
        <span class="mf">0.8820224719101123</span><span class="p">,</span>
        <span class="mf">0.8632478632478634</span><span class="p">,</span>
        <span class="mf">0.8632478632478634</span><span class="p">,</span>
        <span class="mf">0.9999999999999999</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.1829268292682927</span><span class="p">,</span>
        <span class="mf">0.1331867494623916</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.35</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.9999999999999999</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.8717948717948719</span><span class="p">,</span>
        <span class="mf">0.8877524294796135</span><span class="p">,</span>
        <span class="mf">0.8932584269662921</span><span class="p">,</span>
        <span class="mf">0.8717948717948719</span><span class="p">,</span>
        <span class="mf">0.8717948717948719</span><span class="p">,</span>
        <span class="mf">0.9999999999999999</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">1.0000000000000002</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.9999999999999999</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.8803418803418804</span><span class="p">,</span>
        <span class="mf">0.8843509879486927</span><span class="p">,</span>
        <span class="mf">0.8820224719101123</span><span class="p">,</span>
        <span class="mf">0.8803418803418804</span><span class="p">,</span>
        <span class="mf">0.8803418803418804</span><span class="p">,</span>
        <span class="mf">0.9999999999999999</span><span class="p">,</span>
        <span class="mf">0.1764705882352941</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.4414621899378262</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.9999999999999999</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.8888888888888891</span><span class="p">,</span>
        <span class="mf">0.8877524294796135</span><span class="p">,</span>
        <span class="mf">0.8820224719101123</span><span class="p">,</span>
        <span class="mf">0.8888888888888891</span><span class="p">,</span>
        <span class="mf">0.8888888888888891</span><span class="p">,</span>
        <span class="mf">0.9999999999999999</span><span class="p">,</span>
        <span class="mf">0.23529411764705882</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.9512194052347446</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.9999999999999999</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.8974358974358976</span><span class="p">,</span>
        <span class="mf">0.9013581956032967</span><span class="p">,</span>
        <span class="mf">0.898876404494382</span><span class="p">,</span>
        <span class="mf">0.8974358974358976</span><span class="p">,</span>
        <span class="mf">0.8974358974358976</span><span class="p">,</span>
        <span class="mf">0.9999999999999999</span><span class="p">,</span>
        <span class="mf">0.2941176470588235</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.8536582157042338</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.9999999999999999</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.9059829059829061</span><span class="p">,</span>
        <span class="mf">0.894555312541455</span><span class="p">,</span>
        <span class="mf">0.8820224719101123</span><span class="p">,</span>
        <span class="mf">0.9059829059829061</span><span class="p">,</span>
        <span class="mf">0.9059829059829061</span><span class="p">,</span>
        <span class="mf">0.9999999999999999</span><span class="p">,</span>
        <span class="mf">0.3529411764705882</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.9024388104694893</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.9999999999999999</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.9145299145299146</span><span class="p">,</span>
        <span class="mf">0.9047596371342175</span><span class="p">,</span>
        <span class="mf">0.8932584269662921</span><span class="p">,</span>
        <span class="mf">0.9145299145299146</span><span class="p">,</span>
        <span class="mf">0.9145299145299146</span><span class="p">,</span>
        <span class="mf">0.9999999999999999</span><span class="p">,</span>
        <span class="mf">0.4117647058823529</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.9999999999999999</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.9230769230769232</span><span class="p">,</span>
        <span class="mf">0.9081610786651383</span><span class="p">,</span>
        <span class="mf">0.8932584269662921</span><span class="p">,</span>
        <span class="mf">0.9230769230769232</span><span class="p">,</span>
        <span class="mf">0.9230769230769232</span><span class="p">,</span>
        <span class="mf">0.9999999999999999</span><span class="p">,</span>
        <span class="mf">0.47058823529411764</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.8536582157042338</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.9999999999999999</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.9316239316239318</span><span class="p">,</span>
        <span class="mf">0.9183654032579007</span><span class="p">,</span>
        <span class="mf">0.9044943820224719</span><span class="p">,</span>
        <span class="mf">0.9316239316239318</span><span class="p">,</span>
        <span class="mf">0.9316239316239318</span><span class="p">,</span>
        <span class="mf">0.9999999999999999</span><span class="p">,</span>
        <span class="mf">0.5294117647058824</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.9999999999999999</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.9401709401709403</span><span class="p">,</span>
        <span class="mf">0.9217668447888215</span><span class="p">,</span>
        <span class="mf">0.9044943820224719</span><span class="p">,</span>
        <span class="mf">0.9401709401709403</span><span class="p">,</span>
        <span class="mf">0.9401709401709403</span><span class="p">,</span>
        <span class="mf">0.9999999999999999</span><span class="p">,</span>
        <span class="mf">0.5882352941176471</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.9999999999999999</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.9487179487179489</span><span class="p">,</span>
        <span class="mf">0.965985584690792</span><span class="p">,</span>
        <span class="mf">0.9719101123595505</span><span class="p">,</span>
        <span class="mf">0.9487179487179489</span><span class="p">,</span>
        <span class="mf">0.9487179487179489</span><span class="p">,</span>
        <span class="mf">0.9999999999999999</span><span class="p">,</span>
        <span class="mf">0.6470588235294117</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.9999999999999999</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.9572649572649574</span><span class="p">,</span>
        <span class="mf">0.9625841431598712</span><span class="p">,</span>
        <span class="mf">0.9606741573033708</span><span class="p">,</span>
        <span class="mf">0.9572649572649574</span><span class="p">,</span>
        <span class="mf">0.9572649572649574</span><span class="p">,</span>
        <span class="mf">0.9999999999999999</span><span class="p">,</span>
        <span class="mf">0.7058823529411764</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.9999999999999999</span><span class="p">,</span>
        <span class="mf">0.2857142857142857</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.9658119658119659</span><span class="p">,</span>
        <span class="mf">0.9795913508144752</span><span class="p">,</span>
        <span class="mf">0.9831460674157303</span><span class="p">,</span>
        <span class="mf">0.9658119658119659</span><span class="p">,</span>
        <span class="mf">0.9658119658119659</span><span class="p">,</span>
        <span class="mf">0.9999999999999999</span><span class="p">,</span>
        <span class="mf">0.7647058823529411</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.9999999999999999</span><span class="p">,</span>
        <span class="mf">0.42857142857142855</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.9743589743589745</span><span class="p">,</span>
        <span class="mf">0.9761899092835544</span><span class="p">,</span>
        <span class="mf">0.9719101123595505</span><span class="p">,</span>
        <span class="mf">0.9743589743589745</span><span class="p">,</span>
        <span class="mf">0.9743589743589745</span><span class="p">,</span>
        <span class="mf">0.9999999999999999</span><span class="p">,</span>
        <span class="mf">0.8235294117647058</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.9999999999999999</span><span class="p">,</span>
        <span class="mf">0.5714285714285714</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.9829059829059831</span><span class="p">,</span>
        <span class="mf">0.9897956754072376</span><span class="p">,</span>
        <span class="mf">0.9887640449438202</span><span class="p">,</span>
        <span class="mf">0.9829059829059831</span><span class="p">,</span>
        <span class="mf">0.9829059829059831</span><span class="p">,</span>
        <span class="mf">0.9999999999999999</span><span class="p">,</span>
        <span class="mf">0.8823529411764706</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.9999999999999999</span><span class="p">,</span>
        <span class="mf">0.7142857142857142</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">0.9914529914529915</span><span class="p">,</span>
        <span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.9914529914529915</span><span class="p">,</span>
        <span class="mf">0.9914529914529915</span><span class="p">,</span>
        <span class="mf">0.9999999999999999</span><span class="p">,</span>
        <span class="mf">0.9411764705882353</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.9999999999999999</span><span class="p">,</span>
        <span class="mf">0.8571428571428572</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="mf">1.0000000000000002</span><span class="p">,</span>
        <span class="mf">0.9965985584690792</span><span class="p">,</span>
        <span class="mf">0.9887640449438202</span><span class="p">,</span>
        <span class="mf">1.0000000000000002</span><span class="p">,</span>
        <span class="mf">1.0000000000000002</span><span class="p">,</span>
        <span class="mf">0.9999999999999999</span><span class="p">,</span>
        <span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">0.9999999999999999</span><span class="p">,</span>
        <span class="mf">1.0</span><span class="p">,</span>
    <span class="p">],</span>
<span class="p">]</span>


<span class="nd">@torch</span><span class="o">.</span><span class="n">jit</span><span class="o">.</span><span class="n">script</span>
<span class="k">def</span> <span class="nf">gaussian</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">mean</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">std</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute the Gaussian distribution probability density.&quot;&quot;&quot;</span>
    <span class="n">pi</span> <span class="o">=</span> <span class="mf">3.14159</span>
    <span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">pi</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span>
    <span class="n">output</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="p">(((</span><span class="n">x</span> <span class="o">-</span> <span class="n">mean</span><span class="p">)</span> <span class="o">/</span> <span class="n">std</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="n">std</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">output</span>


<div class="viewcode-block" id="GaussianLayer">
<a class="viewcode-back" href="../../../reference/api/atomgen.models.unimolplus.html#atomgen.models.unimolplus.GaussianLayer">[docs]</a>
<span class="k">class</span> <span class="nc">GaussianLayer</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gaussian pairwise positional embedding layer.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">128</span><span class="p">,</span> <span class="n">edge_types</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1024</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">k</span> <span class="o">=</span> <span class="n">k</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">means</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Embedding</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stds</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Embedding</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mul</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Embedding</span><span class="p">(</span><span class="n">edge_types</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bias</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Embedding</span><span class="p">(</span><span class="n">edge_types</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">nn</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">uniform_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">means</span><span class="o">.</span><span class="n">weight</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">nn</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">uniform_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stds</span><span class="o">.</span><span class="n">weight</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">nn</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">constant_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="o">.</span><span class="n">weight</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">nn</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">constant_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mul</span><span class="o">.</span><span class="n">weight</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<div class="viewcode-block" id="GaussianLayer.forward">
<a class="viewcode-back" href="../../../reference/api/atomgen.models.unimolplus.html#atomgen.models.unimolplus.GaussianLayer.forward">[docs]</a>
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">edge_types</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Forward pass to compute the Gaussian pos. embeddings.&quot;&quot;&quot;</span>
        <span class="n">mul</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">edge_types</span><span class="p">)</span>
        <span class="n">bias</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">(</span><span class="n">edge_types</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">mul</span> <span class="o">*</span> <span class="n">x</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">bias</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">)</span>
        <span class="n">mean</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">means</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">std</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stds</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span> <span class="o">+</span> <span class="mf">1e-5</span>
        <span class="n">output</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">=</span> <span class="n">gaussian</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">float</span><span class="p">(),</span> <span class="n">mean</span><span class="p">,</span> <span class="n">std</span><span class="p">)</span><span class="o">.</span><span class="n">type_as</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">means</span><span class="o">.</span><span class="n">weight</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">output</span></div>
</div>



<div class="viewcode-block" id="ParallelBlock">
<a class="viewcode-back" href="../../../reference/api/atomgen.models.unimolplus.html#atomgen.models.unimolplus.ParallelBlock">[docs]</a>
<span class="k">class</span> <span class="nc">ParallelBlock</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Parallel transformer block (MLP &amp; Attention in parallel).</span>

<span class="sd">    Based on:</span>
<span class="sd">      &#39;Scaling Vision Transformers to 22 Billion Parameters` - https://arxiv.org/abs/2302.05442</span>

<span class="sd">    Adapted from TIMM implementation.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">dim</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">num_heads</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">mlp_ratio</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
        <span class="n">dropout</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="n">k</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">128</span><span class="p">,</span>
        <span class="n">op_hidden_dim</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">16</span><span class="p">,</span>
        <span class="n">tr_hidden_dim</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">16</span><span class="p">,</span>
        <span class="n">gradient_checkpointing</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="k">assert</span> <span class="p">(</span>
            <span class="n">dim</span> <span class="o">%</span> <span class="n">num_heads</span> <span class="o">==</span> <span class="mi">0</span>
        <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;dim </span><span class="si">{</span><span class="n">dim</span><span class="si">}</span><span class="s2"> should be divisible by num_heads </span><span class="si">{</span><span class="n">num_heads</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_heads</span> <span class="o">=</span> <span class="n">num_heads</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">head_dim</span> <span class="o">=</span> <span class="n">dim</span> <span class="o">//</span> <span class="n">num_heads</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scale</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">head_dim</span><span class="o">**-</span><span class="mf">0.5</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mlp_hidden_dim</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">mlp_ratio</span> <span class="o">*</span> <span class="n">dim</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">proj_drop</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="n">dropout</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">attn_drop</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="n">dropout</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gradient_checkpointing</span> <span class="o">=</span> <span class="n">gradient_checkpointing</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">in_proj_in_dim</span> <span class="o">=</span> <span class="n">dim</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">in_proj_out_dim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mlp_hidden_dim</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">dim</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">out_proj_in_dim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mlp_hidden_dim</span> <span class="o">+</span> <span class="n">dim</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">out_proj_out_dim</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">dim</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">in_split</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">mlp_hidden_dim</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">dim</span><span class="p">]</span> <span class="o">*</span> <span class="mi">3</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">out_split</span> <span class="o">=</span> <span class="p">[</span><span class="n">dim</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">in_norm</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">LayerNorm</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">q_norm</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">LayerNorm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">head_dim</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">k_norm</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">LayerNorm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">head_dim</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">in_proj</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">in_proj_in_dim</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_proj_out_dim</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">act_fn</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">GELU</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">out_proj</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">out_proj_in_dim</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_proj_out_dim</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="kc">False</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gaussian_proj</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pos_embed_ff_norm</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">LayerNorm</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>

<div class="viewcode-block" id="ParallelBlock.forward">
<a class="viewcode-back" href="../../../reference/api/atomgen.models.unimolplus.html#atomgen.models.unimolplus.ParallelBlock.forward">[docs]</a>
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">x</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
        <span class="n">pos_embed</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
        <span class="n">attention_mask</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Forward pass for the parallel block.&quot;&quot;&quot;</span>
        <span class="n">b</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">x</span>

        <span class="c1"># Combined MLP fc1 &amp; qkv projections</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_proj</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">in_norm</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_split</span><span class="p">,</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">act_fn</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_drop</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

        <span class="c1"># Dot product attention</span>
        <span class="n">q</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">q_norm</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_heads</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">head_dim</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
        <span class="n">k</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">k_norm</span><span class="p">(</span><span class="n">k</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_heads</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">head_dim</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_heads</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">head_dim</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

        <span class="n">x_attn</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">f</span><span class="o">.</span><span class="n">scaled_dot_product_attention</span><span class="p">(</span>
                <span class="n">q</span><span class="p">,</span>
                <span class="n">k</span><span class="p">,</span>
                <span class="n">v</span><span class="p">,</span>
                <span class="n">attn_mask</span><span class="o">=</span><span class="n">attention_mask</span>
                <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">gaussian_proj</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pos_embed_ff_norm</span><span class="p">(</span><span class="n">pos_embed</span><span class="p">))</span><span class="o">.</span><span class="n">permute</span><span class="p">(</span>
                    <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span>
                <span class="p">),</span>
                <span class="n">is_causal</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
            <span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="c1"># Combined MLP fc2 &amp; attn_output projection</span>
        <span class="n">x_mlp</span><span class="p">,</span> <span class="n">x_attn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_proj</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">x_attn</span><span class="p">],</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">split</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">out_split</span><span class="p">,</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span>
        <span class="p">)</span>
        <span class="c1"># Residual connections</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x_mlp</span> <span class="o">+</span> <span class="n">x_attn</span> <span class="o">+</span> <span class="n">res</span>
        <span class="k">del</span> <span class="n">x_mlp</span><span class="p">,</span> <span class="n">x_attn</span><span class="p">,</span> <span class="n">res</span>

        <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">pos_embed</span></div>
</div>



<div class="viewcode-block" id="TransformerConfig">
<a class="viewcode-back" href="../../../reference/api/atomgen.models.unimolplus.html#atomgen.models.unimolplus.TransformerConfig">[docs]</a>
<span class="k">class</span> <span class="nc">TransformerConfig</span><span class="p">(</span><span class="n">PretrainedConfig</span><span class="p">):</span>  <span class="c1"># type: ignore</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Configuration of a :class:`~transform:class:`~transformers.UniMolPlusModel`.</span>

<span class="sd">    It is used to instantiate an UniMolPlus model according to the specified arguments.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">model_type</span> <span class="o">=</span> <span class="s2">&quot;transformer&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">vocab_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">123</span><span class="p">,</span>
        <span class="n">dim</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">768</span><span class="p">,</span>
        <span class="n">num_heads</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">32</span><span class="p">,</span>
        <span class="n">depth</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">12</span><span class="p">,</span>
        <span class="n">mlp_ratio</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
        <span class="n">k</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">128</span><span class="p">,</span>
        <span class="n">op_hidden_dim</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">16</span><span class="p">,</span>
        <span class="n">tr_hidden_dim</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">16</span><span class="p">,</span>
        <span class="n">dropout</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="n">mask_token_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">pad_token_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">119</span><span class="p">,</span>
        <span class="n">bos_token_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">120</span><span class="p">,</span>
        <span class="n">eos_token_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">121</span><span class="p">,</span>
        <span class="n">cls_token_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">122</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vocab_size</span> <span class="o">=</span> <span class="n">vocab_size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dim</span> <span class="o">=</span> <span class="n">dim</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_heads</span> <span class="o">=</span> <span class="n">num_heads</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">depth</span> <span class="o">=</span> <span class="n">depth</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mlp_ratio</span> <span class="o">=</span> <span class="n">mlp_ratio</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">k</span> <span class="o">=</span> <span class="n">k</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">op_hidden_dim</span> <span class="o">=</span> <span class="n">op_hidden_dim</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tr_hidden_dim</span> <span class="o">=</span> <span class="n">tr_hidden_dim</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">dropout</span> <span class="o">=</span> <span class="n">dropout</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mask_token_id</span> <span class="o">=</span> <span class="n">mask_token_id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pad_token_id</span> <span class="o">=</span> <span class="n">pad_token_id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bos_token_id</span> <span class="o">=</span> <span class="n">bos_token_id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eos_token_id</span> <span class="o">=</span> <span class="n">eos_token_id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cls_token_id</span> <span class="o">=</span> <span class="n">cls_token_id</span></div>



<div class="viewcode-block" id="TransformerEncoder">
<a class="viewcode-back" href="../../../reference/api/atomgen.models.unimolplus.html#atomgen.models.unimolplus.TransformerEncoder">[docs]</a>
<span class="k">class</span> <span class="nc">TransformerEncoder</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;UniMolPlus Transformer encoder.</span>

<span class="sd">    The transformer encoder consists of a series of parallel blocks,</span>
<span class="sd">    each containing a multi-head self-attention mechanism and a feed-forward network.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">TransformerConfig</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vocab_size</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">vocab_size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dim</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">dim</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_heads</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">num_heads</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">depth</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">depth</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mlp_ratio</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">mlp_ratio</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dropout</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">dropout</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">k</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">k</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">op_hidden_dim</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">op_hidden_dim</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tr_hidden_dim</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">tr_hidden_dim</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gradient_checkpointing</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">gradient_checkpointing</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">metadata_vocab</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Embedding</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vocab_size</span><span class="p">,</span> <span class="mi">17</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metadata_vocab</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">requires_grad</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metadata_vocab</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">fill_</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metadata_vocab</span><span class="o">.</span><span class="n">weight</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span>
            <span class="n">ATOM_METADATA</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">embed_metadata</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dim</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">gaussian_embed</span> <span class="o">=</span> <span class="n">GaussianLayer</span><span class="p">(</span>
            <span class="n">k</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span> <span class="n">edge_types</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vocab_size</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">embed_tokens</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Embedding</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">vocab_size</span><span class="p">,</span> <span class="n">config</span><span class="o">.</span><span class="n">dim</span><span class="p">)</span>
        <span class="n">nn</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">normal_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">embed_tokens</span><span class="o">.</span><span class="n">weight</span><span class="p">,</span> <span class="n">std</span><span class="o">=</span><span class="mf">0.02</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">blocks</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">ModuleList</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">depth</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">blocks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">ParallelBlock</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">dim</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">num_heads</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">mlp_ratio</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">op_hidden_dim</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">tr_hidden_dim</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">gradient_checkpointing</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_expand_mask</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">mask</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
        <span class="n">dtype</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span>
        <span class="n">device</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">,</span>
        <span class="n">tgt_len</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Expand attention mask.</span>

<span class="sd">        Expands attention_mask from `[bsz, seq_len]` to</span>
<span class="sd">        `[bsz, 1, tgt_seq_len, src_seq_len]`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">bsz</span><span class="p">,</span> <span class="n">src_len</span> <span class="o">=</span> <span class="n">mask</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
        <span class="n">tgt_len</span> <span class="o">=</span> <span class="n">tgt_len</span> <span class="k">if</span> <span class="n">tgt_len</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">src_len</span>

        <span class="n">expanded_mask</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">mask</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">bsz</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">tgt_len</span><span class="p">,</span> <span class="n">src_len</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="n">inverted_mask</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">expanded_mask</span>

        <span class="k">return</span> <span class="n">inverted_mask</span><span class="o">.</span><span class="n">masked_fill</span><span class="p">(</span>
            <span class="n">inverted_mask</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">bool</span><span class="p">),</span> <span class="n">torch</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span><span class="o">.</span><span class="n">min</span>
        <span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>

<div class="viewcode-block" id="TransformerEncoder.forward">
<a class="viewcode-back" href="../../../reference/api/atomgen.models.unimolplus.html#atomgen.models.unimolplus.TransformerEncoder.forward">[docs]</a>
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">input_ids</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
        <span class="n">coords</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
        <span class="n">attention_mask</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Forward pass for the transformer encoder.&quot;&quot;&quot;</span>
        <span class="c1"># pad coords by zeros for graph token</span>
        <span class="n">coords_center</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdim</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">/</span> <span class="n">coords</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">coords</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">coords_center</span><span class="p">,</span> <span class="n">coords</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">r_ij</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cdist</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="n">coords</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># [B, N, N]</span>
        <span class="c1"># pad input_ids by graph token</span>
        <span class="n">input_ids</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span>
                    <span class="n">input_ids</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">long</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">input_ids</span><span class="o">.</span><span class="n">device</span>
                <span class="p">)</span><span class="o">.</span><span class="n">fill_</span><span class="p">(</span><span class="mi">122</span><span class="p">),</span>
                <span class="n">input_ids</span><span class="p">,</span>
            <span class="p">],</span>
            <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">edge_type</span> <span class="o">=</span> <span class="n">input_ids</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">vocab_size</span> <span class="o">+</span> <span class="n">input_ids</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span>
            <span class="o">-</span><span class="mi">2</span>
        <span class="p">)</span>  <span class="c1"># [B, N, N]</span>
        <span class="n">pos_embeds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gaussian_embed</span><span class="p">(</span><span class="n">r_ij</span><span class="p">,</span> <span class="n">edge_type</span><span class="p">)</span>  <span class="c1"># [B, N, N, K]</span>

        <span class="n">input_embeds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">embed_tokens</span><span class="p">(</span><span class="n">input_ids</span><span class="p">)</span>
        <span class="n">atom_metadata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata_vocab</span><span class="p">(</span><span class="n">input_ids</span><span class="p">)</span>
        <span class="n">input_embeds</span> <span class="o">=</span> <span class="n">input_embeds</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">embed_metadata</span><span class="p">(</span><span class="n">atom_metadata</span><span class="p">)</span>  <span class="c1"># [B, N, C]</span>

        <span class="n">attention_mask</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span>
                        <span class="n">attention_mask</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
                        <span class="mi">1</span><span class="p">,</span>
                        <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">bool</span><span class="p">,</span>
                        <span class="n">device</span><span class="o">=</span><span class="n">attention_mask</span><span class="o">.</span><span class="n">device</span><span class="p">,</span>
                    <span class="p">),</span>
                    <span class="n">attention_mask</span><span class="o">.</span><span class="n">bool</span><span class="p">(),</span>
                <span class="p">],</span>
                <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">attention_mask</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="k">else</span> <span class="kc">None</span>
        <span class="p">)</span>

        <span class="n">attention_mask</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_expand_mask</span><span class="p">(</span><span class="n">attention_mask</span><span class="p">,</span> <span class="n">input_embeds</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">input_embeds</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">attention_mask</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="k">else</span> <span class="kc">None</span>
        <span class="p">)</span>

        <span class="k">for</span> <span class="n">blk</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">blocks</span><span class="p">:</span>
            <span class="n">input_embeds</span><span class="p">,</span> <span class="n">pos_embeds</span> <span class="o">=</span> <span class="n">blk</span><span class="p">(</span><span class="n">input_embeds</span><span class="p">,</span> <span class="n">pos_embeds</span><span class="p">,</span> <span class="n">attention_mask</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">input_embeds</span><span class="p">,</span> <span class="n">pos_embeds</span></div>
</div>



<div class="viewcode-block" id="TransformerPreTrainedModel">
<a class="viewcode-back" href="../../../reference/api/atomgen.models.unimolplus.html#atomgen.models.unimolplus.TransformerPreTrainedModel">[docs]</a>
<span class="k">class</span> <span class="nc">TransformerPreTrainedModel</span><span class="p">(</span><span class="n">PreTrainedModel</span><span class="p">):</span>  <span class="c1"># type: ignore</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base class for all transformer models.&quot;&quot;&quot;</span>

    <span class="n">config_class</span> <span class="o">=</span> <span class="n">TransformerConfig</span>
    <span class="n">base_model_prefix</span> <span class="o">=</span> <span class="s2">&quot;model&quot;</span>
    <span class="n">supports_gradient_checkpointing</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">_no_split_modules</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;ParallelBlock&quot;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">_set_gradient_checkpointing</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">module</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="p">(</span><span class="n">TransformerEncoder</span><span class="p">)):</span>
            <span class="n">module</span><span class="o">.</span><span class="n">gradient_checkpointing</span> <span class="o">=</span> <span class="n">value</span></div>



<div class="viewcode-block" id="TransformerModel">
<a class="viewcode-back" href="../../../reference/api/atomgen.models.unimolplus.html#atomgen.models.unimolplus.TransformerModel">[docs]</a>
<span class="k">class</span> <span class="nc">TransformerModel</span><span class="p">(</span><span class="n">TransformerPreTrainedModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Transformer model for atom modeling.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">TransformerConfig</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="n">config</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">encoder</span> <span class="o">=</span> <span class="n">TransformerEncoder</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>

<div class="viewcode-block" id="TransformerModel.forward">
<a class="viewcode-back" href="../../../reference/api/atomgen.models.unimolplus.html#atomgen.models.unimolplus.TransformerModel.forward">[docs]</a>
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">input_ids</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
        <span class="n">coords</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
        <span class="n">attention_mask</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Forward function call for the transformer model.&quot;&quot;&quot;</span>
        <span class="n">output</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoder</span><span class="p">(</span><span class="n">input_ids</span><span class="p">,</span> <span class="n">coords</span><span class="p">,</span> <span class="n">attention_mask</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">output</span></div>
</div>



<div class="viewcode-block" id="TransformerForMaskedAM">
<a class="viewcode-back" href="../../../reference/api/atomgen.models.unimolplus.html#atomgen.models.unimolplus.TransformerForMaskedAM">[docs]</a>
<span class="k">class</span> <span class="nc">TransformerForMaskedAM</span><span class="p">(</span><span class="n">TransformerPreTrainedModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Transformer with an atom modeling head on top for masked atom modeling.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">TransformerConfig</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="n">config</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">encoder</span> <span class="o">=</span> <span class="n">TransformerEncoder</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">am_head</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">dim</span><span class="p">,</span> <span class="n">config</span><span class="o">.</span><span class="n">vocab_size</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<div class="viewcode-block" id="TransformerForMaskedAM.forward">
<a class="viewcode-back" href="../../../reference/api/atomgen.models.unimolplus.html#atomgen.models.unimolplus.TransformerForMaskedAM.forward">[docs]</a>
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">input_ids</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
        <span class="n">coords</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
        <span class="n">labels</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">fixed</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">attention_mask</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">],</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Forward function call for the masked atom modeling model.&quot;&quot;&quot;</span>
        <span class="n">hidden_states</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoder</span><span class="p">(</span><span class="n">input_ids</span><span class="p">,</span> <span class="n">coords</span><span class="p">,</span> <span class="n">attention_mask</span><span class="p">)</span>
        <span class="n">logits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">am_head</span><span class="p">(</span><span class="n">hidden_states</span><span class="p">)</span>

        <span class="n">loss</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">labels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">loss_fct</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">CrossEntropyLoss</span><span class="p">()</span>
            <span class="n">logits</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">logits</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">vocab_size</span><span class="p">),</span> <span class="n">labels</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">loss</span> <span class="o">=</span> <span class="n">loss_fct</span><span class="p">(</span><span class="n">logits</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">loss</span><span class="p">,</span> <span class="n">logits</span></div>
</div>



<div class="viewcode-block" id="TransformerForCoordinateAM">
<a class="viewcode-back" href="../../../reference/api/atomgen.models.unimolplus.html#atomgen.models.unimolplus.TransformerForCoordinateAM">[docs]</a>
<span class="k">class</span> <span class="nc">TransformerForCoordinateAM</span><span class="p">(</span><span class="n">TransformerPreTrainedModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Transformer with an atom coordinate head on top for coordinate denoising.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">TransformerConfig</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="n">config</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">encoder</span> <span class="o">=</span> <span class="n">TransformerEncoder</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coords_head</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">dim</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

<div class="viewcode-block" id="TransformerForCoordinateAM.forward">
<a class="viewcode-back" href="../../../reference/api/atomgen.models.unimolplus.html#atomgen.models.unimolplus.TransformerForCoordinateAM.forward">[docs]</a>
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">input_ids</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
        <span class="n">coords</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
        <span class="n">labels_coords</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">fixed</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">attention_mask</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">],</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Forward function call for the coordinate atom modeling model.&quot;&quot;&quot;</span>
        <span class="n">hidden_states</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoder</span><span class="p">(</span><span class="n">input_ids</span><span class="p">,</span> <span class="n">coords</span><span class="p">,</span> <span class="n">attention_mask</span><span class="p">)</span>
        <span class="n">coords_pred</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coords_head</span><span class="p">(</span><span class="n">hidden_states</span><span class="p">)</span>

        <span class="n">loss</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">labels_coords</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">labels_coords</span> <span class="o">=</span> <span class="n">labels_coords</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">coords_pred</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
            <span class="n">loss_fct</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">L1Loss</span><span class="p">()</span>
            <span class="n">loss</span> <span class="o">=</span> <span class="n">loss_fct</span><span class="p">(</span><span class="n">coords_pred</span><span class="p">,</span> <span class="n">labels_coords</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">loss</span><span class="p">,</span> <span class="n">coords_pred</span></div>
</div>



<div class="viewcode-block" id="InitialStructure2RelaxedStructure">
<a class="viewcode-back" href="../../../reference/api/atomgen.models.unimolplus.html#atomgen.models.unimolplus.InitialStructure2RelaxedStructure">[docs]</a>
<span class="k">class</span> <span class="nc">InitialStructure2RelaxedStructure</span><span class="p">(</span><span class="n">TransformerPreTrainedModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Transformer with an coordinate head on top for relaxed structure prediction.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">TransformerConfig</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="n">config</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">encoder</span> <span class="o">=</span> <span class="n">TransformerEncoder</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coords_head</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">dim</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

<div class="viewcode-block" id="InitialStructure2RelaxedStructure.forward">
<a class="viewcode-back" href="../../../reference/api/atomgen.models.unimolplus.html#atomgen.models.unimolplus.InitialStructure2RelaxedStructure.forward">[docs]</a>
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">input_ids</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
        <span class="n">coords</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
        <span class="n">labels_coords</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">fixed</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">attention_mask</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">],</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Forward function call.</span>

<span class="sd">        Initial structure to relaxed structure model.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">hidden_states</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoder</span><span class="p">(</span><span class="n">input_ids</span><span class="p">,</span> <span class="n">coords</span><span class="p">,</span> <span class="n">attention_mask</span><span class="p">)</span>
        <span class="n">coords_pred</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coords_head</span><span class="p">(</span><span class="n">hidden_states</span><span class="p">)</span>

        <span class="n">loss</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">labels_coords</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">labels_coords</span> <span class="o">=</span> <span class="n">labels_coords</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">coords_pred</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
            <span class="n">loss_fct</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">L1Loss</span><span class="p">()</span>
            <span class="n">loss</span> <span class="o">=</span> <span class="n">loss_fct</span><span class="p">(</span><span class="n">coords_pred</span><span class="p">,</span> <span class="n">labels_coords</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">loss</span><span class="p">,</span> <span class="n">coords_pred</span></div>
</div>



<div class="viewcode-block" id="InitialStructure2RelaxedEnergy">
<a class="viewcode-back" href="../../../reference/api/atomgen.models.unimolplus.html#atomgen.models.unimolplus.InitialStructure2RelaxedEnergy">[docs]</a>
<span class="k">class</span> <span class="nc">InitialStructure2RelaxedEnergy</span><span class="p">(</span><span class="n">TransformerPreTrainedModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Transformer with an energy head on top for relaxed energy prediction.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">TransformerConfig</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="n">config</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">encoder</span> <span class="o">=</span> <span class="n">TransformerEncoder</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">energy_norm</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">LayerNorm</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">dim</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">energy_head</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">dim</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<div class="viewcode-block" id="InitialStructure2RelaxedEnergy.forward">
<a class="viewcode-back" href="../../../reference/api/atomgen.models.unimolplus.html#atomgen.models.unimolplus.InitialStructure2RelaxedEnergy.forward">[docs]</a>
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">input_ids</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
        <span class="n">coords</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
        <span class="n">labels_energy</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">fixed</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">attention_mask</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">],</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Forward function call for the relaxed energy prediction model.&quot;&quot;&quot;</span>
        <span class="n">hidden_states</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoder</span><span class="p">(</span><span class="n">input_ids</span><span class="p">,</span> <span class="n">coords</span><span class="p">,</span> <span class="n">attention_mask</span><span class="p">)</span>
        <span class="n">energy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">energy_head</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">energy_norm</span><span class="p">(</span><span class="n">hidden_states</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]))</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">loss</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">labels_energy</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">loss_fct</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">L1Loss</span><span class="p">()</span>
            <span class="n">loss</span> <span class="o">=</span> <span class="n">loss_fct</span><span class="p">(</span><span class="n">energy</span><span class="p">,</span> <span class="n">labels_energy</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">loss</span><span class="p">,</span> <span class="n">energy</span></div>
</div>



<div class="viewcode-block" id="InitialStructure2RelaxedStructureAndEnergy">
<a class="viewcode-back" href="../../../reference/api/atomgen.models.unimolplus.html#atomgen.models.unimolplus.InitialStructure2RelaxedStructureAndEnergy">[docs]</a>
<span class="k">class</span> <span class="nc">InitialStructure2RelaxedStructureAndEnergy</span><span class="p">(</span><span class="n">TransformerPreTrainedModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Transformer with an coordinate and energy head.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">TransformerConfig</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="n">config</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">encoder</span> <span class="o">=</span> <span class="n">TransformerEncoder</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">energy_norm</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">LayerNorm</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">dim</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">energy_head</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">dim</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coords_head</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">dim</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

<div class="viewcode-block" id="InitialStructure2RelaxedStructureAndEnergy.forward">
<a class="viewcode-back" href="../../../reference/api/atomgen.models.unimolplus.html#atomgen.models.unimolplus.InitialStructure2RelaxedStructureAndEnergy.forward">[docs]</a>
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">input_ids</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
        <span class="n">coords</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
        <span class="n">labels_coords</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">forces</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">total_energy</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">formation_energy</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">has_formation_energy</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">attention_mask</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Forward function call for the relaxed structure and energy model.&quot;&quot;&quot;</span>
        <span class="n">atom_hidden_states</span><span class="p">,</span> <span class="n">pos_hidden_states</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoder</span><span class="p">(</span>
            <span class="n">input_ids</span><span class="p">,</span> <span class="n">coords</span><span class="p">,</span> <span class="n">attention_mask</span>
        <span class="p">)</span>

        <span class="n">formation_energy_pred</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">formation_energy_head</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">energy_norm</span><span class="p">(</span><span class="n">atom_hidden_states</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span>
        <span class="p">)</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">loss_formation_energy</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">formation_energy</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">loss_fct</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">L1Loss</span><span class="p">()</span>
            <span class="n">loss_formation_energy</span> <span class="o">=</span> <span class="n">loss_fct</span><span class="p">(</span>
                <span class="n">formation_energy_pred</span><span class="p">[</span><span class="n">has_formation_energy</span><span class="p">],</span>
                <span class="n">formation_energy</span><span class="p">[</span><span class="n">has_formation_energy</span><span class="p">],</span>
            <span class="p">)</span>
        <span class="n">coords_pred</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coords_head</span><span class="p">(</span><span class="n">atom_hidden_states</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:])</span>
        <span class="n">loss_coords</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">labels_coords</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">loss_fct</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">L1Loss</span><span class="p">()</span>
            <span class="n">loss_coords</span> <span class="o">=</span> <span class="n">loss_fct</span><span class="p">(</span><span class="n">coords_pred</span><span class="p">,</span> <span class="n">labels_coords</span><span class="p">)</span>

        <span class="n">loss</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">coords</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">loss</span> <span class="o">+</span> <span class="n">loss_formation_energy</span> <span class="k">if</span> <span class="n">loss_formation_energy</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">loss</span>
        <span class="p">)</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="n">loss</span> <span class="o">+</span> <span class="n">loss_coords</span> <span class="k">if</span> <span class="n">loss_coords</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">loss</span>

        <span class="k">return</span> <span class="n">loss</span><span class="p">,</span> <span class="p">(</span><span class="n">formation_energy_pred</span><span class="p">,</span> <span class="n">coords_pred</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="Structure2Energy">
<a class="viewcode-back" href="../../../reference/api/atomgen.models.unimolplus.html#atomgen.models.unimolplus.Structure2Energy">[docs]</a>
<span class="k">class</span> <span class="nc">Structure2Energy</span><span class="p">(</span><span class="n">TransformerPreTrainedModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Transformer with an atom modeling head on top for masked atom modeling.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">TransformerConfig</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="n">config</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">encoder</span> <span class="o">=</span> <span class="n">TransformerEncoder</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">energy_norm</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">LayerNorm</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">dim</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formation_energy_head</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">dim</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<div class="viewcode-block" id="Structure2Energy.forward">
<a class="viewcode-back" href="../../../reference/api/atomgen.models.unimolplus.html#atomgen.models.unimolplus.Structure2Energy.forward">[docs]</a>
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">input_ids</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
        <span class="n">coords</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
        <span class="n">forces</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">total_energy</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">formation_energy</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">has_formation_energy</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">attention_mask</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">],</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Forward function call for the structure to energy model.&quot;&quot;&quot;</span>
        <span class="n">atom_hidden_states</span><span class="p">,</span> <span class="n">pos_hidden_states</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoder</span><span class="p">(</span>
            <span class="n">input_ids</span><span class="p">,</span> <span class="n">coords</span><span class="p">,</span> <span class="n">attention_mask</span>
        <span class="p">)</span>

        <span class="n">formation_energy_pred</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">formation_energy_head</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">energy_norm</span><span class="p">(</span><span class="n">atom_hidden_states</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span>
        <span class="p">)</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">coords</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">formation_energy</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">loss_fct</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">L1Loss</span><span class="p">()</span>
            <span class="n">loss</span> <span class="o">=</span> <span class="n">loss_fct</span><span class="p">(</span>
                <span class="n">formation_energy_pred</span><span class="p">[</span><span class="n">has_formation_energy</span><span class="p">],</span>
                <span class="n">formation_energy</span><span class="p">[</span><span class="n">has_formation_energy</span><span class="p">],</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">loss</span><span class="p">,</span> <span class="p">(</span>
            <span class="n">formation_energy_pred</span><span class="p">,</span>
            <span class="n">attention_mask</span><span class="o">.</span><span class="n">bool</span><span class="p">()</span> <span class="k">if</span> <span class="n">attention_mask</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
        <span class="p">)</span></div>
</div>



<div class="viewcode-block" id="Structure2Forces">
<a class="viewcode-back" href="../../../reference/api/atomgen.models.unimolplus.html#atomgen.models.unimolplus.Structure2Forces">[docs]</a>
<span class="k">class</span> <span class="nc">Structure2Forces</span><span class="p">(</span><span class="n">TransformerPreTrainedModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Transformer with a forces head on top for forces prediction.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">TransformerConfig</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="n">config</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">encoder</span> <span class="o">=</span> <span class="n">TransformerEncoder</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">force_norm</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">LayerNorm</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">dim</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">force_head</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">dim</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">energy_norm</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">LayerNorm</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">dim</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formation_energy_head</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">dim</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<div class="viewcode-block" id="Structure2Forces.forward">
<a class="viewcode-back" href="../../../reference/api/atomgen.models.unimolplus.html#atomgen.models.unimolplus.Structure2Forces.forward">[docs]</a>
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">input_ids</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
        <span class="n">coords</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
        <span class="n">forces</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">total_energy</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">formation_energy</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">has_formation_energy</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">attention_mask</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Forward function call for the structure to forces model.&quot;&quot;&quot;</span>
        <span class="n">atom_hidden_states</span><span class="p">,</span> <span class="n">pos_hidden_states</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoder</span><span class="p">(</span>
            <span class="n">input_ids</span><span class="p">,</span> <span class="n">coords</span><span class="p">,</span> <span class="n">attention_mask</span>
        <span class="p">)</span>
        <span class="n">attention_mask</span> <span class="o">=</span> <span class="n">attention_mask</span><span class="o">.</span><span class="n">bool</span><span class="p">()</span> <span class="k">if</span> <span class="n">attention_mask</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>

        <span class="n">forces_pred</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">force_head</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">force_norm</span><span class="p">(</span><span class="n">atom_hidden_states</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:])</span>
        <span class="p">)</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">coords</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">forces</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">loss_fct</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">L1Loss</span><span class="p">()</span>
            <span class="n">loss</span> <span class="o">=</span> <span class="n">loss_fct</span><span class="p">(</span><span class="n">forces_pred</span><span class="p">[</span><span class="n">attention_mask</span><span class="p">],</span> <span class="n">forces</span><span class="p">[</span><span class="n">attention_mask</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">loss</span><span class="p">,</span> <span class="p">(</span>
            <span class="n">forces_pred</span><span class="p">,</span>
            <span class="n">attention_mask</span> <span class="k">if</span> <span class="n">attention_mask</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
        <span class="p">)</span></div>
</div>



<div class="viewcode-block" id="Structure2EnergyAndForces">
<a class="viewcode-back" href="../../../reference/api/atomgen.models.unimolplus.html#atomgen.models.unimolplus.Structure2EnergyAndForces">[docs]</a>
<span class="k">class</span> <span class="nc">Structure2EnergyAndForces</span><span class="p">(</span><span class="n">TransformerPreTrainedModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Transformer with an energy and forces head for energy and forces prediction.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">TransformerConfig</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="n">config</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">encoder</span> <span class="o">=</span> <span class="n">TransformerEncoder</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">force_norm</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">LayerNorm</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">dim</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">force_head</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">dim</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">energy_norm</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">LayerNorm</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">dim</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formation_energy_head</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">dim</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<div class="viewcode-block" id="Structure2EnergyAndForces.forward">
<a class="viewcode-back" href="../../../reference/api/atomgen.models.unimolplus.html#atomgen.models.unimolplus.Structure2EnergyAndForces.forward">[docs]</a>
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">input_ids</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
        <span class="n">coords</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
        <span class="n">forces</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">total_energy</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">formation_energy</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">has_formation_energy</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">attention_mask</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">Optional</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Forward function call for the structure to energy and forces model.&quot;&quot;&quot;</span>
        <span class="n">atom_hidden_states</span><span class="p">,</span> <span class="n">pos_hidden_states</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoder</span><span class="p">(</span>
            <span class="n">input_ids</span><span class="p">,</span> <span class="n">coords</span><span class="p">,</span> <span class="n">attention_mask</span>
        <span class="p">)</span>

        <span class="n">formation_energy_pred</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">formation_energy_head</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">energy_norm</span><span class="p">(</span><span class="n">atom_hidden_states</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span>
        <span class="p">)</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">loss_formation_energy</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">formation_energy</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">loss_fct</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">L1Loss</span><span class="p">()</span>
            <span class="n">loss_formation_energy</span> <span class="o">=</span> <span class="n">loss_fct</span><span class="p">(</span>
                <span class="n">formation_energy_pred</span><span class="p">[</span><span class="n">has_formation_energy</span><span class="p">],</span>
                <span class="n">formation_energy</span><span class="p">[</span><span class="n">has_formation_energy</span><span class="p">],</span>
            <span class="p">)</span>
        <span class="n">attention_mask</span> <span class="o">=</span> <span class="n">attention_mask</span><span class="o">.</span><span class="n">bool</span><span class="p">()</span> <span class="k">if</span> <span class="n">attention_mask</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="n">forces_pred</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">force_head</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">force_norm</span><span class="p">(</span><span class="n">atom_hidden_states</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:])</span>
        <span class="p">)</span>
        <span class="n">loss_forces</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">forces</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">loss_fct</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">L1Loss</span><span class="p">()</span>
            <span class="n">loss_forces</span> <span class="o">=</span> <span class="n">loss_fct</span><span class="p">(</span><span class="n">forces_pred</span><span class="p">[</span><span class="n">attention_mask</span><span class="p">],</span> <span class="n">forces</span><span class="p">[</span><span class="n">attention_mask</span><span class="p">])</span>

        <span class="n">loss</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">coords</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">loss</span> <span class="o">+</span> <span class="n">loss_formation_energy</span> <span class="k">if</span> <span class="n">loss_formation_energy</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">loss</span>
        <span class="p">)</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="n">loss</span> <span class="o">+</span> <span class="n">loss_forces</span> <span class="k">if</span> <span class="n">loss_forces</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">loss</span>

        <span class="k">return</span> <span class="n">loss</span><span class="p">,</span> <span class="p">(</span><span class="n">formation_energy_pred</span><span class="p">,</span> <span class="n">forces_pred</span><span class="p">,</span> <span class="n">attention_mask</span><span class="p">)</span></div>
</div>

</pre></div>
        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          
          
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2024, Vector AI Engineering
            </div>
            <!--
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
            -->
          </div>
          <div class="right-details">
            <div class="icons">
              <a class="muted-link " href="https://github.com/VectorInstitute/atomgen" aria-label="GitHub">
                <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path>
                </svg>
            </a>
              
            </div>
          </div>
        </div>
        <div class="footer-container" style="text-align: center;">
          <div class="logo">
            <a class="logo" href="https://vectorinstitute.ai/">
              <span class="logo"></span>
              <img alt="Logo of the Vector Institute" style="width:90px; max-width:90px;" src="../../../_static/logos/vector_logo.png" />
            </a>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer no-toc">
      
      
      
    </aside>
  </div>
</div></body>
</html>